{"title":"Linear regression modules using the fev dataset","markdown":{"yaml":{"title":"Linear regression modules using the fev dataset","author":"Steve Simon","format":{"html":{"embed-resources":true}},"date":"2024-09-25"},"headingText":"Libraries","containsRefs":false,"markdown":"\n\nThere is a [data dictionary][dd] that provides more details about the data. The program was written by Steve Simon on 2024-09-02 and is placed in the public domain.\n\n[dd]: https://github.com/pmean/datasets/blob/master/fev.yaml\n\n\nYou should always load the tidyverse library. The broom library provides the glance, tidy, and augment functions that help you with computations of linear regression models. The car library provides the vif function for measuing collinearity.\n\n```{r setup}\n#| message: false\n#| warning: false\nlibrary(broom)\nlibrary(car)\nlibrary(tidyverse)\n```\n\n## List variable names\n\nSince the variable names are not listed in the data file itself, you need to list them here.\n\n```{r names}\npulmonary_names <- c(\n    \"age\",\n    \"fev\",\n    \"height\",\n    \"sex\",\n    \"smoke\")\n```\n\n## Reading the data\n\nHere is the code to read the data and show a glimpse. \n\n```{r read}\npulmonary <- read_csv(\n  file=\"../data/fev.csv\",\n  col_names=pulmonary_names,\n  col_types=\"nnncc\")\nglimpse(pulmonary)\n```\n\n## m1: Linear regression model using sex to predict fev\n\nIs there a relationship between sex and fev? Do males tend to have larger fev values than females. This section (labelled m1) shows some simple descriptive and graphical summaries followed by a linear regression model.\n\n## m1: Descriptive stastics for sex\n\n```{r sex}\npulmonary |>\n\tcount(sex) |>\n\tmutate(total=sum(n)) |>\n\tmutate(pct=100*n/total)\n```\n\nThere are slightly more males (51%) than females in this sample.\n\n## m1: Descriptive statistics for fev\n\n```{r fev}\npulmonary |>\n  summarize(\n    fev_mn=mean(fev),\n    fev_sd=sd(fev),\n    fev_min=min(fev),\n    fev_max=max(fev))\n```\n\nThe average fev value, 2.6, seems reasonable. The standard deviation, 0.87, indicates a fair amount of variation. The minimum and maximum values both appear to be reasonable.\n\n## m1: Tabular summary of the relationship between sex and fev, 1\n\n```{r sex-and-fev-1}\npulmonary |>\n  group_by(sex) |>\n\tsummarize(\n\t\tfev_mn=mean(fev),\n\t\tfev_sd=sd(fev))\n```\n\nThe average fev is 0.36 liters higher for males than females. There is very slightly more variation in the males (the standard deviation is 1.00 versus 0.65).\n\n## m1: Graphical summary of the relationship between sex and fev, 2\n\n```{r sex-and-fev-2}\npulmonary |>\n  ggplot(aes(sex, fev)) +\n    geom_boxplot() + \n    coord_flip() +\n    ggtitle(\"Graph drawn by Steve Simon on 2024-09-26\") +\n\t  xlab(\"Sex\") +\n\t  ylab(\"Forced Expiratory Volume (liters)\")\n```\n\nThe boxplot shows the same pattern slightly larger fev values for males compared to females and slightly more variation. \n\n## m1: Fit the linear regression model\n\n```{r m1-model}\nm1 <- lm(fev ~ sex, data=pulmonary)\nm1\n```\n\nThe estimated average fev is 2.45 for females and 0.36 inches higher for males.\n\n## m1: Analysis of variance table\n\n```{r m1-anova}\nanova(m1)\n```\n\nThe F-statistic, 29.6, is large, and the p-value is very small (< 0.001). Reject the null hypothesis and conclude that the average fev values are different between males and females.\n\n## m1: R-squared\n\n```{r m1-r-squared}\nglance(m1)$r.squared\n```\n\nSex is a very weak predictor of fev. Only 4% of the variation in fev values can be accounted for by a patient's sex.\n\n## m1: Confidence intervals\n\n```{r m1-ci}\nconfint(m1)\n```\n\nWe are 95% confident that the difference in fev values is between 0.23 and 0.49. This is a positive difference for all values in the confidence interval, demonstrating that the average fev values are larger for males than for females. This interval is narrow indicating that there is very little sampling error. Hardly a surprise with such a large dataset (n=654).\n\n## m1: T-tests\n\n```{r m1-t-tests}\ntidy(m1)\n```\n\nThe t-statistic, 5.4, is not close to zero. Conclude that there is a difference in average fev values between males and females. Since the t-statistic is positive, conclude also that the average fev value is larger for males.\n\n## m1: Normal probability plot of residuals, 1\n\nNote: I learn something new everyday. You do not have to use qqnorm to create a normal probability plot. You can do it using the ggplot and stat_qq functions. This looks nicer, is consistent with other visualizations in R, and allows you to put in a title using ggtitle. In your homework, you are welcome to use this approach (ggplot and stat_qq) or you can use qqnorm.\n\n## m1: Normal probability plot of residuals, 2\n\n```{r m1-qq-plot}\nr1 <- augment(m1)\nr1 |>\n\tggplot(aes(sample=.resid)) +\n\t  stat_qq() +\n    ggtitle(\"Graph drawn by Steve Simon on 2024-09-30\")\n```\n\nThe straight lines indicates that the residuals are normally distributed.\n\n## m1: Histogram of residuals\n\n```{r m1-histogram}\nr1 |>\n\tggplot(aes(.resid)) +\n\t  geom_histogram(\n\t  \tbinwidth=0.2,\n\t  \tcolor=\"black\",\n\t  \tfill=\"white\") +\n    ggtitle(\"Graph drawn by Steve Simon on 2024-09-26\") +\n\t  xlab(\"Residuals from m1 regression model\")\n```\n\nThe histogram also indicates that the residuals are normally distributed.\n\n## m1: Influential data points\n\nBoth leverage and Cook's distance make little sense for a regression model using a categorical independent variable. The studentized deleted residual is still useful.\n\n```{r m1-studentized-deleted-residual}\nr1 |>\n\tfilter(abs(.std.resid) > 3)\n```\n\nThere are three outliers on the high end, corresponding to fev values of 5.6, 5.6, and 5.8 liters in males. There are no outliers among the female patients.\n\n## m2: Linear regression model using smoke to predict fev\n\nIs there a relationship between smoke and fev? This section (labeled m2) shows some simple descriptive and graphical summaries followed by a linear regression model.\n\n## m2: Descriptive statistics for smoke\n\n```{r smoke}\npulmonary |>\n\tcount(smoke) |>\n\tmutate(total=sum(n)) |>\n\tmutate(pct=100*n/total)\n```\n\nThere are very few smokers (65 or 10%) in this sample. Descriptive statistics for fev were shown earlier.\n\n## m2: Relationship between smoke and fev, 1\n\n```{r smoke-and-fev-1}\npulmonary |>\n  group_by(smoke) |>\n\tsummarize(\n\t\tfev_mn=mean(fev),\n\t\tfev_sd=sd(fev))\n```\n\nSmokers have an average fev value that is 0.7 units higher than non-smokers. The standard deviations (0.85 and 0.75) demonstrate roughly the same amount of variation in the two groups.\n\n## m2: Relationship between smoke and fev, 2\n\n```{r smoke-and-fev-2}\npulmonary |>\n  ggplot(aes(smoke, fev)) +\n    geom_boxplot() + \n    coord_flip() +\n    ggtitle(\"Graph drawn by Steve Simon on 2024-09-26\") +\n\t  xlab(\"Did the patient smoke?\") +\n\t  ylab(\"Forced Expiratory Volume (liters)\")\n```\n\nThe boxplot shows the same pattern as noted above.\n\n## m2: Fit the linear regression model\n\n```{r m2-model}\nm2 <- lm(fev ~ smoke, data=pulmonary)\nm2\n```\n\nThe estimated average fev is 2.57 liters for non-smokers and 0.71 liters higher on average for smokers.\n\nNormally, you would follow this up with various functions (anova, confint, tidy), assess various diagnostic plots using the residuals, and identify influential data points.\n\n## m3: Linear regression model using age and height to predict fev\n\nPrevious analysis has shown that age by itself is a strong predictor of fev and height by itself is a strong predictor of fev. A multiple linear regression model including both age and height should do an even better job in predicting fev. This model will also allow you to compare the relative importance of the two variables. Is fev most strongly associated with how big a child is or how old that child is?\n\nYou should always start with descriptive statistics and graphs. With two or more independent variables, you should also examine the correlations between the independent variables and their correlations with the dependent variable.\n\n## m3: Descriptive statistics for age\n\n```{r age}\npulmonary |>\n  summarize(\n    age_mn=mean(age),\n    age_sd=sd(age),\n    age_min=min(age),\n    age_max=max(age))\n```\n\nThe descriptive statistics are consistent with a pediatric study. The average age is 9.9 years. The standard deviation, 3.0, shows a large amount of variation in age (large at least for a pediatric study). The range, 3 years to 19 years, also demonstrates a large amount of variation.\n\n## m3: Descriptive statistics for height\n\n```{r height}\npulmonary |>\n  summarize(\n    ht_mn=mean(height),\n    ht_sd=sd(height),\n    ht_min=min(height),\n    ht_max=max(height))\n```\n\nThe average height, 61 inches, is reasonable for a group of children with an average age of around 10 years. The standard deviation, 5.7 inches, and the range, 46 inches to 74 inches, show a moderate amount of variation.\n\n## m3: Correlations\n\nReduce the pulmonary data frame to just the first three columns before computing correlations.\n\n```{r corr}\npulmonary |>\n  select(height, age, fev) |> \n  cor()\n```\n\nThe two independent variables, age and ht, are both strongly correlated with fev (r=0.76 and 0.87). They are also strongly correlated with one another (r=0.79).\n\n## m3: Predicting fev using age and ht\n\n```{r m3}\nm3 <- lm(fev ~ age + height, data=pulmonary)\nm3\n```\n\nThe estimated average fev value increases by 0.05 liters for each increase of one year in age, holding height constant. The estimated average fev value increases by 0.11 liters for every increase of one inch in height. The estimated average fev is -4.6 for a patient of age zero with a height of zero inches. This is clearly and extrapolation beyond the range of the data.\n\n## m3: Confidence intervals, 1\n\nThe use of [2, ] (and of [3, ]) isolates the individual rows of the data frame produced by confint. This is not really necessary, but is done to fit the information easily on separate slides.\n\n```{r m3-ci-1}\nm3\nconfint(m3)[2, ]\n```\n\nWe are 95% confident that the estimated average fev value increases between 0.036 and 0.072 liters for each increase of one year of age holding height constant. Conclude that there is a positive relationship between fev and age.\n\n## m3: Confidence intervals, 2\n\n```{r m3-ci-2}\nconfint(m3)[3, ]\n```\n\nWe are 95% confident that the estimated average fev value increases between 0.10 and 0.12 liters for each increase of one inch in patient's height holding age constant. Conclude that there is a positive relationship between height and fev.\n\nDo not interpret the confidence interval for the intercept.\n\n## m3: Analysis of variance table\n\n```{r m3-anova}\nanova(m3)\n```\n\nThe sum of squares total (SST) is 280.9 + 95.3 + 114.7 = 490.9. Only a small portion of the variation (114.7) is unexplained variation. The F-ratio is much larger than 1, and the p-value is less than 0.001. You can conclude that the combination of age and height helps significantly in predicting fev.\n\n## m3: R-squared\n\n```{r m3-r-squared}\nglance(m3)$r.squared\n```\n\nRoughly 77% of the variation in fev can be explained by the combination of the age and height of the patients.\n\n## m3: t-tests\n\n```{r}\ntidy(m3)\n```\n\n## m3: Diagnostic plots, 1\n\n```{r diagnostic-1}\nr3 <- augment(m3)\nr3 |>\n\tggplot(aes(sample=.resid)) +\n\t  stat_qq() +\n    ggtitle(\"Graph drawn by Steve Simon on 2024-09-30\")\n```\n\n## m3: Diagnostic plots, 2\n\n```{r diagnostic-2}\nr3 |>\n  ggplot(aes(.resid)) +\n    geom_histogram(\n      binwidth=0.2,\n      color=\"black\",\n      fill=\"white\") +\n    xlab(\"Residuals from m3 regression\") +\n    ggtitle(\"Graph drawn by Steve Simon on 2024-09-25\")\n```\n\n## m3: Diagnostic plots, 3\n\n```{r diagnostic-3}\nr3 |>\n  ggplot(aes(.fitted, .resid)) +\n    geom_point() +\n    xlab(\"Predicted values from m3 regression\") +\n    ylab(\"Residuals from m3 regression\") +\n    ggtitle(\"Graph drawn by Steve Simon on 2024-09-25\")\n```\n\n## m3: Influential data points, 1\n\n```{r influence-1}\nn <- nrow(r3)\nr3 |> filter(.hat > 3*3/n)\n```\n\n\n\n## m3: Influential data points, 2\n\n```{r influence-2}\nr3 |> \n  filter(abs(.std.resid) > 3)\n```\n\n## m3: Influential data points, 3\n\n```{r influence-3}\nr3 |> \n  filter(.cooksd > 1)\n```\n\n## m3: Variance inflation factor\n\n```{r vif}\nlibrary(car)\nvif(m3)\n```","srcMarkdownNoYaml":"\n\nThere is a [data dictionary][dd] that provides more details about the data. The program was written by Steve Simon on 2024-09-02 and is placed in the public domain.\n\n[dd]: https://github.com/pmean/datasets/blob/master/fev.yaml\n\n## Libraries\n\nYou should always load the tidyverse library. The broom library provides the glance, tidy, and augment functions that help you with computations of linear regression models. The car library provides the vif function for measuing collinearity.\n\n```{r setup}\n#| message: false\n#| warning: false\nlibrary(broom)\nlibrary(car)\nlibrary(tidyverse)\n```\n\n## List variable names\n\nSince the variable names are not listed in the data file itself, you need to list them here.\n\n```{r names}\npulmonary_names <- c(\n    \"age\",\n    \"fev\",\n    \"height\",\n    \"sex\",\n    \"smoke\")\n```\n\n## Reading the data\n\nHere is the code to read the data and show a glimpse. \n\n```{r read}\npulmonary <- read_csv(\n  file=\"../data/fev.csv\",\n  col_names=pulmonary_names,\n  col_types=\"nnncc\")\nglimpse(pulmonary)\n```\n\n## m1: Linear regression model using sex to predict fev\n\nIs there a relationship between sex and fev? Do males tend to have larger fev values than females. This section (labelled m1) shows some simple descriptive and graphical summaries followed by a linear regression model.\n\n## m1: Descriptive stastics for sex\n\n```{r sex}\npulmonary |>\n\tcount(sex) |>\n\tmutate(total=sum(n)) |>\n\tmutate(pct=100*n/total)\n```\n\nThere are slightly more males (51%) than females in this sample.\n\n## m1: Descriptive statistics for fev\n\n```{r fev}\npulmonary |>\n  summarize(\n    fev_mn=mean(fev),\n    fev_sd=sd(fev),\n    fev_min=min(fev),\n    fev_max=max(fev))\n```\n\nThe average fev value, 2.6, seems reasonable. The standard deviation, 0.87, indicates a fair amount of variation. The minimum and maximum values both appear to be reasonable.\n\n## m1: Tabular summary of the relationship between sex and fev, 1\n\n```{r sex-and-fev-1}\npulmonary |>\n  group_by(sex) |>\n\tsummarize(\n\t\tfev_mn=mean(fev),\n\t\tfev_sd=sd(fev))\n```\n\nThe average fev is 0.36 liters higher for males than females. There is very slightly more variation in the males (the standard deviation is 1.00 versus 0.65).\n\n## m1: Graphical summary of the relationship between sex and fev, 2\n\n```{r sex-and-fev-2}\npulmonary |>\n  ggplot(aes(sex, fev)) +\n    geom_boxplot() + \n    coord_flip() +\n    ggtitle(\"Graph drawn by Steve Simon on 2024-09-26\") +\n\t  xlab(\"Sex\") +\n\t  ylab(\"Forced Expiratory Volume (liters)\")\n```\n\nThe boxplot shows the same pattern slightly larger fev values for males compared to females and slightly more variation. \n\n## m1: Fit the linear regression model\n\n```{r m1-model}\nm1 <- lm(fev ~ sex, data=pulmonary)\nm1\n```\n\nThe estimated average fev is 2.45 for females and 0.36 inches higher for males.\n\n## m1: Analysis of variance table\n\n```{r m1-anova}\nanova(m1)\n```\n\nThe F-statistic, 29.6, is large, and the p-value is very small (< 0.001). Reject the null hypothesis and conclude that the average fev values are different between males and females.\n\n## m1: R-squared\n\n```{r m1-r-squared}\nglance(m1)$r.squared\n```\n\nSex is a very weak predictor of fev. Only 4% of the variation in fev values can be accounted for by a patient's sex.\n\n## m1: Confidence intervals\n\n```{r m1-ci}\nconfint(m1)\n```\n\nWe are 95% confident that the difference in fev values is between 0.23 and 0.49. This is a positive difference for all values in the confidence interval, demonstrating that the average fev values are larger for males than for females. This interval is narrow indicating that there is very little sampling error. Hardly a surprise with such a large dataset (n=654).\n\n## m1: T-tests\n\n```{r m1-t-tests}\ntidy(m1)\n```\n\nThe t-statistic, 5.4, is not close to zero. Conclude that there is a difference in average fev values between males and females. Since the t-statistic is positive, conclude also that the average fev value is larger for males.\n\n## m1: Normal probability plot of residuals, 1\n\nNote: I learn something new everyday. You do not have to use qqnorm to create a normal probability plot. You can do it using the ggplot and stat_qq functions. This looks nicer, is consistent with other visualizations in R, and allows you to put in a title using ggtitle. In your homework, you are welcome to use this approach (ggplot and stat_qq) or you can use qqnorm.\n\n## m1: Normal probability plot of residuals, 2\n\n```{r m1-qq-plot}\nr1 <- augment(m1)\nr1 |>\n\tggplot(aes(sample=.resid)) +\n\t  stat_qq() +\n    ggtitle(\"Graph drawn by Steve Simon on 2024-09-30\")\n```\n\nThe straight lines indicates that the residuals are normally distributed.\n\n## m1: Histogram of residuals\n\n```{r m1-histogram}\nr1 |>\n\tggplot(aes(.resid)) +\n\t  geom_histogram(\n\t  \tbinwidth=0.2,\n\t  \tcolor=\"black\",\n\t  \tfill=\"white\") +\n    ggtitle(\"Graph drawn by Steve Simon on 2024-09-26\") +\n\t  xlab(\"Residuals from m1 regression model\")\n```\n\nThe histogram also indicates that the residuals are normally distributed.\n\n## m1: Influential data points\n\nBoth leverage and Cook's distance make little sense for a regression model using a categorical independent variable. The studentized deleted residual is still useful.\n\n```{r m1-studentized-deleted-residual}\nr1 |>\n\tfilter(abs(.std.resid) > 3)\n```\n\nThere are three outliers on the high end, corresponding to fev values of 5.6, 5.6, and 5.8 liters in males. There are no outliers among the female patients.\n\n## m2: Linear regression model using smoke to predict fev\n\nIs there a relationship between smoke and fev? This section (labeled m2) shows some simple descriptive and graphical summaries followed by a linear regression model.\n\n## m2: Descriptive statistics for smoke\n\n```{r smoke}\npulmonary |>\n\tcount(smoke) |>\n\tmutate(total=sum(n)) |>\n\tmutate(pct=100*n/total)\n```\n\nThere are very few smokers (65 or 10%) in this sample. Descriptive statistics for fev were shown earlier.\n\n## m2: Relationship between smoke and fev, 1\n\n```{r smoke-and-fev-1}\npulmonary |>\n  group_by(smoke) |>\n\tsummarize(\n\t\tfev_mn=mean(fev),\n\t\tfev_sd=sd(fev))\n```\n\nSmokers have an average fev value that is 0.7 units higher than non-smokers. The standard deviations (0.85 and 0.75) demonstrate roughly the same amount of variation in the two groups.\n\n## m2: Relationship between smoke and fev, 2\n\n```{r smoke-and-fev-2}\npulmonary |>\n  ggplot(aes(smoke, fev)) +\n    geom_boxplot() + \n    coord_flip() +\n    ggtitle(\"Graph drawn by Steve Simon on 2024-09-26\") +\n\t  xlab(\"Did the patient smoke?\") +\n\t  ylab(\"Forced Expiratory Volume (liters)\")\n```\n\nThe boxplot shows the same pattern as noted above.\n\n## m2: Fit the linear regression model\n\n```{r m2-model}\nm2 <- lm(fev ~ smoke, data=pulmonary)\nm2\n```\n\nThe estimated average fev is 2.57 liters for non-smokers and 0.71 liters higher on average for smokers.\n\nNormally, you would follow this up with various functions (anova, confint, tidy), assess various diagnostic plots using the residuals, and identify influential data points.\n\n## m3: Linear regression model using age and height to predict fev\n\nPrevious analysis has shown that age by itself is a strong predictor of fev and height by itself is a strong predictor of fev. A multiple linear regression model including both age and height should do an even better job in predicting fev. This model will also allow you to compare the relative importance of the two variables. Is fev most strongly associated with how big a child is or how old that child is?\n\nYou should always start with descriptive statistics and graphs. With two or more independent variables, you should also examine the correlations between the independent variables and their correlations with the dependent variable.\n\n## m3: Descriptive statistics for age\n\n```{r age}\npulmonary |>\n  summarize(\n    age_mn=mean(age),\n    age_sd=sd(age),\n    age_min=min(age),\n    age_max=max(age))\n```\n\nThe descriptive statistics are consistent with a pediatric study. The average age is 9.9 years. The standard deviation, 3.0, shows a large amount of variation in age (large at least for a pediatric study). The range, 3 years to 19 years, also demonstrates a large amount of variation.\n\n## m3: Descriptive statistics for height\n\n```{r height}\npulmonary |>\n  summarize(\n    ht_mn=mean(height),\n    ht_sd=sd(height),\n    ht_min=min(height),\n    ht_max=max(height))\n```\n\nThe average height, 61 inches, is reasonable for a group of children with an average age of around 10 years. The standard deviation, 5.7 inches, and the range, 46 inches to 74 inches, show a moderate amount of variation.\n\n## m3: Correlations\n\nReduce the pulmonary data frame to just the first three columns before computing correlations.\n\n```{r corr}\npulmonary |>\n  select(height, age, fev) |> \n  cor()\n```\n\nThe two independent variables, age and ht, are both strongly correlated with fev (r=0.76 and 0.87). They are also strongly correlated with one another (r=0.79).\n\n## m3: Predicting fev using age and ht\n\n```{r m3}\nm3 <- lm(fev ~ age + height, data=pulmonary)\nm3\n```\n\nThe estimated average fev value increases by 0.05 liters for each increase of one year in age, holding height constant. The estimated average fev value increases by 0.11 liters for every increase of one inch in height. The estimated average fev is -4.6 for a patient of age zero with a height of zero inches. This is clearly and extrapolation beyond the range of the data.\n\n## m3: Confidence intervals, 1\n\nThe use of [2, ] (and of [3, ]) isolates the individual rows of the data frame produced by confint. This is not really necessary, but is done to fit the information easily on separate slides.\n\n```{r m3-ci-1}\nm3\nconfint(m3)[2, ]\n```\n\nWe are 95% confident that the estimated average fev value increases between 0.036 and 0.072 liters for each increase of one year of age holding height constant. Conclude that there is a positive relationship between fev and age.\n\n## m3: Confidence intervals, 2\n\n```{r m3-ci-2}\nconfint(m3)[3, ]\n```\n\nWe are 95% confident that the estimated average fev value increases between 0.10 and 0.12 liters for each increase of one inch in patient's height holding age constant. Conclude that there is a positive relationship between height and fev.\n\nDo not interpret the confidence interval for the intercept.\n\n## m3: Analysis of variance table\n\n```{r m3-anova}\nanova(m3)\n```\n\nThe sum of squares total (SST) is 280.9 + 95.3 + 114.7 = 490.9. Only a small portion of the variation (114.7) is unexplained variation. The F-ratio is much larger than 1, and the p-value is less than 0.001. You can conclude that the combination of age and height helps significantly in predicting fev.\n\n## m3: R-squared\n\n```{r m3-r-squared}\nglance(m3)$r.squared\n```\n\nRoughly 77% of the variation in fev can be explained by the combination of the age and height of the patients.\n\n## m3: t-tests\n\n```{r}\ntidy(m3)\n```\n\n## m3: Diagnostic plots, 1\n\n```{r diagnostic-1}\nr3 <- augment(m3)\nr3 |>\n\tggplot(aes(sample=.resid)) +\n\t  stat_qq() +\n    ggtitle(\"Graph drawn by Steve Simon on 2024-09-30\")\n```\n\n## m3: Diagnostic plots, 2\n\n```{r diagnostic-2}\nr3 |>\n  ggplot(aes(.resid)) +\n    geom_histogram(\n      binwidth=0.2,\n      color=\"black\",\n      fill=\"white\") +\n    xlab(\"Residuals from m3 regression\") +\n    ggtitle(\"Graph drawn by Steve Simon on 2024-09-25\")\n```\n\n## m3: Diagnostic plots, 3\n\n```{r diagnostic-3}\nr3 |>\n  ggplot(aes(.fitted, .resid)) +\n    geom_point() +\n    xlab(\"Predicted values from m3 regression\") +\n    ylab(\"Residuals from m3 regression\") +\n    ggtitle(\"Graph drawn by Steve Simon on 2024-09-25\")\n```\n\n## m3: Influential data points, 1\n\n```{r influence-1}\nn <- nrow(r3)\nr3 |> filter(.hat > 3*3/n)\n```\n\n\n\n## m3: Influential data points, 2\n\n```{r influence-2}\nr3 |> \n  filter(abs(.std.resid) > 3)\n```\n\n## m3: Influential data points, 3\n\n```{r influence-3}\nr3 |> \n  filter(.cooksd > 1)\n```\n\n## m3: Variance inflation factor\n\n```{r vif}\nlibrary(car)\nvif(m3)\n```"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","embed-resources":true,"output-file":"simon-5501-07-fev.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","title":"Linear regression modules using the fev dataset","author":"Steve Simon","date":"2024-09-25"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":[]}