{"title":"Analysis of fruitfly data","markdown":{"yaml":{"title":"Analysis of fruitfly data","format":{"html":{"embed-resources":true}}},"headingText":"Load the tidyverse library","containsRefs":false,"markdown":"\n\nThis program reads data on fruit fly longevity. Find more information in the [data dictionary][dd].\n\n[dd]: https://github.com/pmean/data/blob/master/files/fruitfly.yaml\n\nThis code was written by Steve Simon and Leroy Wheeler on 2024-11-07 and is placed in the public\ndomain.\n\n\n```{r setup}\n#| message: false\n#| warning: false\nlibrary(broom)\nlibrary(tidyverse)\n```\n\n#### Comments on the code\n\nFor most of your programs, you should load the tidyverse library. The broom \nlibrary converts your output to a nicely arranged dataframe. The messages and\nwarnings are suppressed.\n\n## List the variable names\n\n```{r variable-list}\nvlist <- c(\n  \"id\",\n  \"partners\",\n  \"type\",\n  \"longevity\",\n  \"thorax\",\n  \"sleep\")\n```\n\n#### Comments on the code\n\nWhen a dataset does not have variables on the first line, you need to specify \nthem in the code.\n\n## Read the data and view a brief summary\n\n```{r read}\nfly <- read_fwf(\n  \"../data/fruitfly.txt\",\n  col_types=\"nnnnnn\",\n  fwf_widths(\n    widths=c(2, 2, 2, 3, 5, 3),\n    col_names=vlist))\nglimpse(fly)\n```\n\n#### Comments on the code\n\nThe fruitfly dataset has a fixed width format (fwf). You need to specify the\ncolumns that each variable uses.\n\nNotice that the two categorical variables, partners and type, are actually\nnumbers rather than strings. To avoid having R treat these variables as if\nthey were continuous, use the factor function in some of the code below.\n\n## Create a subset of fruitfly dataset\n\n```{r subset}\nfly |>\n  filter(type != 9) -> fly_subset\n```\n\n#### Comments on the code\n\nIf you exclude the pure control group (No females), you can analyze the two\nfactors, partners and type individually. Partners has two category levels, 1 for\nwhen one female was included in the cage and 8 for when eight females were \nincluded in the cage. Type also has two category levels, 0 for pregnant female\nfly/flies and 1 for virgin fly/flies. A male fly will not mate with a pregnant\nfemales, so you can think of this as a second level of controls. The two factors\nare crossed, meaning that every possible combination of partners and type has \noutcomes measured.\n\n## Question 1: Create a subset of the fruitfly data by removing the age where type equals 9. Draw a clustered boxplot with sleep as the outcome and partners and type as the categorical predictors. Interpret this graph. Is there evidence of non-normality?\n\n```{r boxplots-partners-type}\n#| fig.width: 6\n#| fig.height: 2.5\nfly_subset |>\n  ggplot(aes(factor(partners), sleep, fill=factor(type))) +\n    geom_boxplot() +\n    xlab(\"Number of partners\") +\n    ylab(\"Sleep (% of a day)\") +\n    ggtitle(\"Graph drawn by Leroy Wheeler on 2024-11-07\") +\n    labs(fill=\"Female fly type\") +\n    scale_fill_discrete(labels=c(\"Pregnant\", \"Virgin\")) +\n    coord_flip()\n```\n\n#### Interpretation of the output for question 1.\n\nSleep time appear similar in all groups and it also appears that \nassumptions of homogeneity and normality hold up ok.\n\n## Question 2: Calculate descriptive statistics for sleep (mean, standard deviation, and sample size) by the combination of the two categorical predictors, partners and type. Is there evidence of heterogeneity?\n\n```{r by-partners-and-type}\n#| message: false\nfly_subset |>\n  group_by(type, partners) |>\n  summarize(\n    sleep_mn=mean(sleep),\n    sleep_sd=sd(sleep),\n    n=n()) -> fly_means\nfly_means\n```\n\n#### Interpretation of the output for question 2\n\nThe mean values of sleep time are all similar and the standard deviations are also similar so no evidence of heterogeneity is obvious.\n\n## Question 3: Draw a line graph for the mean sleep levels compared by type and partners. Is there evidence of an interaction?\n\n```{r line-graph}\nfly_means |>\n  ggplot(aes(\n    factor(partners), \n    sleep_mn, \n    group=factor(type),\n    color=factor(type))) +\n    geom_line(linewidth=2) +\n\texpand_limits(y=range(fly_subset$sleep)) +\n  xlab(\"Number of partners\") +\n  ylab(\"Sleep (% of a day)\") +\n  ggtitle(\"Graph drawn by Leroy Wheeler on 2024-11-07\") +\nlabs(color=\"Female fly type\") +\n  scale_color_discrete(labels=c(\"Pregnant\", \"Virgin\"))\n```\n\n## Interpretation of the output for question 3\n\nEven though the two lines cross, we see from the Anova table from question 4 that there is no significant interaction between the number of partners and the partner type.\n\n## Question 4: Analyze the sleep variable using a two factor analysis of variance with an interaction. Present and interpret the analysis of variance table.\n\n```{r anova-with-interaction}\nm1 <- aov(sleep ~ factor(partners)*factor(type), data=fly_subset)\nanova(m1)\n```\n\n## Interpretation of the output for question 4\n\nThere is a no statistically significant interaction between the number of female\npartners and the type of partners (pregnant or virgin). Because there is no interaction, \nwe can also interpret the individual categorical predictors.\nWe see that each categorical shows no evidence of significant influence on sleep time.\n\n## Question 5: What factors might make you consider using a log transformation for the sleep variable? Do not run such an analysis but tell us whether you think the data would warrant such a transformation?\n\nFor the virgin female category there are some outliers to the right in the one partner cage so I might want to run a log transformation on that category.\n\nFor the pregnant female category, there are also some outliers in the eight partner cage, however, there might be some left skewing of that subcategory so I would have to run the log transformation and see if it improves our outcomes.\n\n\n\n\n","srcMarkdownNoYaml":"\n\nThis program reads data on fruit fly longevity. Find more information in the [data dictionary][dd].\n\n[dd]: https://github.com/pmean/data/blob/master/files/fruitfly.yaml\n\nThis code was written by Steve Simon and Leroy Wheeler on 2024-11-07 and is placed in the public\ndomain.\n\n## Load the tidyverse library\n\n```{r setup}\n#| message: false\n#| warning: false\nlibrary(broom)\nlibrary(tidyverse)\n```\n\n#### Comments on the code\n\nFor most of your programs, you should load the tidyverse library. The broom \nlibrary converts your output to a nicely arranged dataframe. The messages and\nwarnings are suppressed.\n\n## List the variable names\n\n```{r variable-list}\nvlist <- c(\n  \"id\",\n  \"partners\",\n  \"type\",\n  \"longevity\",\n  \"thorax\",\n  \"sleep\")\n```\n\n#### Comments on the code\n\nWhen a dataset does not have variables on the first line, you need to specify \nthem in the code.\n\n## Read the data and view a brief summary\n\n```{r read}\nfly <- read_fwf(\n  \"../data/fruitfly.txt\",\n  col_types=\"nnnnnn\",\n  fwf_widths(\n    widths=c(2, 2, 2, 3, 5, 3),\n    col_names=vlist))\nglimpse(fly)\n```\n\n#### Comments on the code\n\nThe fruitfly dataset has a fixed width format (fwf). You need to specify the\ncolumns that each variable uses.\n\nNotice that the two categorical variables, partners and type, are actually\nnumbers rather than strings. To avoid having R treat these variables as if\nthey were continuous, use the factor function in some of the code below.\n\n## Create a subset of fruitfly dataset\n\n```{r subset}\nfly |>\n  filter(type != 9) -> fly_subset\n```\n\n#### Comments on the code\n\nIf you exclude the pure control group (No females), you can analyze the two\nfactors, partners and type individually. Partners has two category levels, 1 for\nwhen one female was included in the cage and 8 for when eight females were \nincluded in the cage. Type also has two category levels, 0 for pregnant female\nfly/flies and 1 for virgin fly/flies. A male fly will not mate with a pregnant\nfemales, so you can think of this as a second level of controls. The two factors\nare crossed, meaning that every possible combination of partners and type has \noutcomes measured.\n\n## Question 1: Create a subset of the fruitfly data by removing the age where type equals 9. Draw a clustered boxplot with sleep as the outcome and partners and type as the categorical predictors. Interpret this graph. Is there evidence of non-normality?\n\n```{r boxplots-partners-type}\n#| fig.width: 6\n#| fig.height: 2.5\nfly_subset |>\n  ggplot(aes(factor(partners), sleep, fill=factor(type))) +\n    geom_boxplot() +\n    xlab(\"Number of partners\") +\n    ylab(\"Sleep (% of a day)\") +\n    ggtitle(\"Graph drawn by Leroy Wheeler on 2024-11-07\") +\n    labs(fill=\"Female fly type\") +\n    scale_fill_discrete(labels=c(\"Pregnant\", \"Virgin\")) +\n    coord_flip()\n```\n\n#### Interpretation of the output for question 1.\n\nSleep time appear similar in all groups and it also appears that \nassumptions of homogeneity and normality hold up ok.\n\n## Question 2: Calculate descriptive statistics for sleep (mean, standard deviation, and sample size) by the combination of the two categorical predictors, partners and type. Is there evidence of heterogeneity?\n\n```{r by-partners-and-type}\n#| message: false\nfly_subset |>\n  group_by(type, partners) |>\n  summarize(\n    sleep_mn=mean(sleep),\n    sleep_sd=sd(sleep),\n    n=n()) -> fly_means\nfly_means\n```\n\n#### Interpretation of the output for question 2\n\nThe mean values of sleep time are all similar and the standard deviations are also similar so no evidence of heterogeneity is obvious.\n\n## Question 3: Draw a line graph for the mean sleep levels compared by type and partners. Is there evidence of an interaction?\n\n```{r line-graph}\nfly_means |>\n  ggplot(aes(\n    factor(partners), \n    sleep_mn, \n    group=factor(type),\n    color=factor(type))) +\n    geom_line(linewidth=2) +\n\texpand_limits(y=range(fly_subset$sleep)) +\n  xlab(\"Number of partners\") +\n  ylab(\"Sleep (% of a day)\") +\n  ggtitle(\"Graph drawn by Leroy Wheeler on 2024-11-07\") +\nlabs(color=\"Female fly type\") +\n  scale_color_discrete(labels=c(\"Pregnant\", \"Virgin\"))\n```\n\n## Interpretation of the output for question 3\n\nEven though the two lines cross, we see from the Anova table from question 4 that there is no significant interaction between the number of partners and the partner type.\n\n## Question 4: Analyze the sleep variable using a two factor analysis of variance with an interaction. Present and interpret the analysis of variance table.\n\n```{r anova-with-interaction}\nm1 <- aov(sleep ~ factor(partners)*factor(type), data=fly_subset)\nanova(m1)\n```\n\n## Interpretation of the output for question 4\n\nThere is a no statistically significant interaction between the number of female\npartners and the type of partners (pregnant or virgin). Because there is no interaction, \nwe can also interpret the individual categorical predictors.\nWe see that each categorical shows no evidence of significant influence on sleep time.\n\n## Question 5: What factors might make you consider using a log transformation for the sleep variable? Do not run such an analysis but tell us whether you think the data would warrant such a transformation?\n\nFor the virgin female category there are some outliers to the right in the one partner cage so I might want to run a log transformation on that category.\n\nFor the pregnant female category, there are also some outliers in the eight partner cage, however, there might be some left skewing of that subcategory so I would have to run the log transformation and see if it improves our outcomes.\n\n\n\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","embed-resources":true,"output-file":"wheeler-5501-12-fruitfly.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","title":"Analysis of fruitfly data"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":[]}