{"title":"Analysis of fruitfly data","markdown":{"yaml":{"title":"Analysis of fruitfly data","format":{"html":{"embed-resources":true}}},"headingText":"Load the tidyverse library","containsRefs":false,"markdown":"\n\nThis program reads data on fruit fly longevity. Find more information in the [data dictionary][dd].\n\n[dd]: https://github.com/pmean/data/blob/master/files/fruitfly.yaml\n\nThis code was written by Steve Simon on 2024-10-23 and is placed in the public domain.\n\n\n```{r setup}\n#| message: false\n#| warning: false\nlibrary(broom)\nlibrary(tidyverse)\n```\n\nFor most of your programs, you should load the tidyverse library. The broom library converts your output to a nicely arranged dataframe. The messages and warnings are suppressed.\n\n## List the variable names\n\n```{r variable-list}\nfn <- \"https://jse.amstat.org/datasets/fruitfly.dat.txt\"\nvlist <- c(\n  \"id\",\n  \"partners\",\n  \"type\",\n  \"longevity\",\n  \"thorax\",\n  \"sleep\")\n```\n\nWhen a dataset does not have variables on the first line, you need to specify them in the code.\n\n## Read the data and view a brief summary\n\n```{r read}\nfly <- read_fwf(\n  \"../data/fruitfly.txt\",\n  col_types=\"nnnnnn\",\n  fwf_widths(\n    widths=c(2, 2, 2, 3, 5, 3),\n    col_names=vlist))\nglimpse(fly)\n```\n\nThe fruitfly dataset has a fixed width format (fwf). You need to specify the columns that each variable uses.\n\n## Create cage groups\n\n```{r cage}\nfly$cage <- \n  case_when(\n    fly$partners==0 & fly$type==9 ~ \"No females\",\n    fly$partners==1 & fly$type==0 ~ \"One pregnant female\",\n    fly$partners==1 & fly$type==1 ~ \"One virgin female\",\n    fly$partners==8 & fly$type==0 ~ \"Eight pregnant females\",\n    fly$partners==8 & fly$type==1 ~ \"Eight virgin females\")\n```\n\nThe five categories represent different combinations of partners and type.\n\n## Calculate descriptive statistics\n\n```{r longevity-means}\nfly |>\n  group_by(cage) |>\n  summarize(\n    longevity_mn=mean(longevity),\n    longevity_sd=sd(longevity),\n    n=n())\n```\n\nThe mean lifespan is much lower for the eight virgin females group. The standard deviations are reasonably small and somewhat consistent across all groups.\n\n## Draw boxplot\n\n```{r longevity-boxplot}\n#| fig.width: 6\n#| fig.height: 2.5\nfly |>\n  ggplot(aes(cage, longevity)) +\n    geom_boxplot() +\n    ggtitle(\"Graph drawn by Steve Simon on 2024-10-23\") +\n    xlab(\"Cage residents\") +\n    ylab(\"Lifespan (days)\") +\n    coord_flip()\n```\n\nThe boxplot also shows that the eight virgin females group has lower lifespans.\nThe variation is roughly comparable across all groups. The distributions are\nreasonably symmetric with no outliers.\n\n## One factor analysis of variance for longevity\n\n```{r longevity-one-factor-anova}\nm1 <- aov(longevity ~ cage, data=fly)\ntidy(m1)\n```\n\nThe F-ratio is large and the p-value is small. Conclude that there is a \ndifference among some or all of the population mean lifespans.\n\n## Linear model for longevity, 1\n\n```{r longevity-lm-1}\nm2 <- lm(longevity ~ cage, data=fly)\nanova(m2)\n```\n\nYou can use linear regression to reach the same conclusion. The sums of squares,\ndegrees of freedom, F-ratio, and p-value all match.\n\n## Linear model for longevity, 2\n\n```{r longevity-lm-2}\ntidy(m2)\n```\n\nThe linear model creates indicator variable for four out of the five category\nlevels. The regression slopes represent the estimated average difference in \nmeans between each category and the reference category.\n\n## Linear model for longevity, 3\n\n```{r longevity-lm-3}\nfly |>\n  group_by(cage) |>\n  summarize(longevity_mn=mean(longevity)) |>\n  mutate(reference_mn=first(longevity_mn)) |>\n  mutate(mean_difference=longevity_mn-reference_mn)\n```\n\nThis table shows how to interpret the intercept and the four slope terms. The\nintercept is the estimated average lifespan for the first level of the\ncategorical variable. The slope terms are the estimated average changes from the\nother levels of the categorical variable and the first level.\n\n## Re-order cage groups, 1\n\n```{r re-order-1}\nfly$cage_1 <- \n  factor(\n    fly$cage,\n    levels = c(\n      \"No females\",\n      \"One pregnant female\",\n      \"Eight pregnant females\",\n      \"One virgin female\",\n      \"Eight virgin females\"))\n```\n\nCompare every category to the No females category (the control condition).\n\n## Re-order cage groups, 2\n\n```{r re-order-2}\nm3 <- lm(longevity ~ cage_1, data=fly)\ntidy(m3)\n```\n\nThere is one group, eight virgin females, that is statistically significantly different from the no female control group.\n\n## Log transformation, 1\n\n```{r log-longevity-anova-1}\nfly |>\n  mutate(log_longevity=log10(longevity)) -> log_fly\nm3 <- aov(log_longevity ~ cage, data=log_fly)\ntidy(m3)\n```\n\nAlthough there are no problems with heterogeneity or non-normality, here is an illustration of how to use a log transformation with analysis of variance.\n\n## Log transformation, 2\n\n```{r log-longevity-anova-2}\nt3 <- TukeyHSD(m3, ordered=TRUE)\nt3\n```\n\n## Log transformation, 3\n\n```{r log-longevity-anova-3}\nt3$cage |>\n  data.frame() |>\n  select(diff, lwr, upr) |> \n  mutate(\n    diff=10^diff,\n    lwr=10^lwr,\n    upr=10^upr)\n```\n\n## Log transformation, 4\n\n```{r log-longevity-anova-4}\nt3$cage |>\n  data.frame() |>\n  select(diff, lwr, upr) |> \n  mutate(\n    diff=10^(-diff),\n    upr=10^(-lwr),\n    lwr=10^(-upr))\n```\n\n## Kruskal-Wallis test\n\n```{r kw}\nkruskal.test(longevity ~ cage, data=fly)\n```\n\nIt may not be needed with this particular dataset, but this is an illustration\nof how to use the Kruskal-Wallis test. \n\n## Save important files for later use\n\n```{r save}\nsave(\n  fly,\n  log_fly,\n  file=\"../data/fruitfly.RData\")\n```","srcMarkdownNoYaml":"\n\nThis program reads data on fruit fly longevity. Find more information in the [data dictionary][dd].\n\n[dd]: https://github.com/pmean/data/blob/master/files/fruitfly.yaml\n\nThis code was written by Steve Simon on 2024-10-23 and is placed in the public domain.\n\n## Load the tidyverse library\n\n```{r setup}\n#| message: false\n#| warning: false\nlibrary(broom)\nlibrary(tidyverse)\n```\n\nFor most of your programs, you should load the tidyverse library. The broom library converts your output to a nicely arranged dataframe. The messages and warnings are suppressed.\n\n## List the variable names\n\n```{r variable-list}\nfn <- \"https://jse.amstat.org/datasets/fruitfly.dat.txt\"\nvlist <- c(\n  \"id\",\n  \"partners\",\n  \"type\",\n  \"longevity\",\n  \"thorax\",\n  \"sleep\")\n```\n\nWhen a dataset does not have variables on the first line, you need to specify them in the code.\n\n## Read the data and view a brief summary\n\n```{r read}\nfly <- read_fwf(\n  \"../data/fruitfly.txt\",\n  col_types=\"nnnnnn\",\n  fwf_widths(\n    widths=c(2, 2, 2, 3, 5, 3),\n    col_names=vlist))\nglimpse(fly)\n```\n\nThe fruitfly dataset has a fixed width format (fwf). You need to specify the columns that each variable uses.\n\n## Create cage groups\n\n```{r cage}\nfly$cage <- \n  case_when(\n    fly$partners==0 & fly$type==9 ~ \"No females\",\n    fly$partners==1 & fly$type==0 ~ \"One pregnant female\",\n    fly$partners==1 & fly$type==1 ~ \"One virgin female\",\n    fly$partners==8 & fly$type==0 ~ \"Eight pregnant females\",\n    fly$partners==8 & fly$type==1 ~ \"Eight virgin females\")\n```\n\nThe five categories represent different combinations of partners and type.\n\n## Calculate descriptive statistics\n\n```{r longevity-means}\nfly |>\n  group_by(cage) |>\n  summarize(\n    longevity_mn=mean(longevity),\n    longevity_sd=sd(longevity),\n    n=n())\n```\n\nThe mean lifespan is much lower for the eight virgin females group. The standard deviations are reasonably small and somewhat consistent across all groups.\n\n## Draw boxplot\n\n```{r longevity-boxplot}\n#| fig.width: 6\n#| fig.height: 2.5\nfly |>\n  ggplot(aes(cage, longevity)) +\n    geom_boxplot() +\n    ggtitle(\"Graph drawn by Steve Simon on 2024-10-23\") +\n    xlab(\"Cage residents\") +\n    ylab(\"Lifespan (days)\") +\n    coord_flip()\n```\n\nThe boxplot also shows that the eight virgin females group has lower lifespans.\nThe variation is roughly comparable across all groups. The distributions are\nreasonably symmetric with no outliers.\n\n## One factor analysis of variance for longevity\n\n```{r longevity-one-factor-anova}\nm1 <- aov(longevity ~ cage, data=fly)\ntidy(m1)\n```\n\nThe F-ratio is large and the p-value is small. Conclude that there is a \ndifference among some or all of the population mean lifespans.\n\n## Linear model for longevity, 1\n\n```{r longevity-lm-1}\nm2 <- lm(longevity ~ cage, data=fly)\nanova(m2)\n```\n\nYou can use linear regression to reach the same conclusion. The sums of squares,\ndegrees of freedom, F-ratio, and p-value all match.\n\n## Linear model for longevity, 2\n\n```{r longevity-lm-2}\ntidy(m2)\n```\n\nThe linear model creates indicator variable for four out of the five category\nlevels. The regression slopes represent the estimated average difference in \nmeans between each category and the reference category.\n\n## Linear model for longevity, 3\n\n```{r longevity-lm-3}\nfly |>\n  group_by(cage) |>\n  summarize(longevity_mn=mean(longevity)) |>\n  mutate(reference_mn=first(longevity_mn)) |>\n  mutate(mean_difference=longevity_mn-reference_mn)\n```\n\nThis table shows how to interpret the intercept and the four slope terms. The\nintercept is the estimated average lifespan for the first level of the\ncategorical variable. The slope terms are the estimated average changes from the\nother levels of the categorical variable and the first level.\n\n## Re-order cage groups, 1\n\n```{r re-order-1}\nfly$cage_1 <- \n  factor(\n    fly$cage,\n    levels = c(\n      \"No females\",\n      \"One pregnant female\",\n      \"Eight pregnant females\",\n      \"One virgin female\",\n      \"Eight virgin females\"))\n```\n\nCompare every category to the No females category (the control condition).\n\n## Re-order cage groups, 2\n\n```{r re-order-2}\nm3 <- lm(longevity ~ cage_1, data=fly)\ntidy(m3)\n```\n\nThere is one group, eight virgin females, that is statistically significantly different from the no female control group.\n\n## Log transformation, 1\n\n```{r log-longevity-anova-1}\nfly |>\n  mutate(log_longevity=log10(longevity)) -> log_fly\nm3 <- aov(log_longevity ~ cage, data=log_fly)\ntidy(m3)\n```\n\nAlthough there are no problems with heterogeneity or non-normality, here is an illustration of how to use a log transformation with analysis of variance.\n\n## Log transformation, 2\n\n```{r log-longevity-anova-2}\nt3 <- TukeyHSD(m3, ordered=TRUE)\nt3\n```\n\n## Log transformation, 3\n\n```{r log-longevity-anova-3}\nt3$cage |>\n  data.frame() |>\n  select(diff, lwr, upr) |> \n  mutate(\n    diff=10^diff,\n    lwr=10^lwr,\n    upr=10^upr)\n```\n\n## Log transformation, 4\n\n```{r log-longevity-anova-4}\nt3$cage |>\n  data.frame() |>\n  select(diff, lwr, upr) |> \n  mutate(\n    diff=10^(-diff),\n    upr=10^(-lwr),\n    lwr=10^(-upr))\n```\n\n## Kruskal-Wallis test\n\n```{r kw}\nkruskal.test(longevity ~ cage, data=fly)\n```\n\nIt may not be needed with this particular dataset, but this is an illustration\nof how to use the Kruskal-Wallis test. \n\n## Save important files for later use\n\n```{r save}\nsave(\n  fly,\n  log_fly,\n  file=\"../data/fruitfly.RData\")\n```"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","embed-resources":true,"output-file":"simon-5501-11-fruitfly.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","title":"Analysis of fruitfly data"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":[]}