{"title":"Analysis of Wolf River pollution","markdown":{"yaml":{"title":"Analysis of Wolf River pollution","format":{"html":{"embed-resources":true}}},"headingText":"Load the tidyverse library","containsRefs":false,"markdown":"\n\nThis program reads data on the relationship sampling depth and two pollutant concentrations. Find more information in the [data dictionary][dd].\n\n[dd]: https://github.com/pmean/datasets/blob/master/wolf-river-pollution.yaml\n\nThis program was written by Steve Simon and Leroy Wheeler on 2024-10-23 and is placed in the public domain.\n\n\nFor most of your programs, you should load the tidyverse library. The messages and warnings are suppressed.\n\n```{r setup}\n#| message: false\n#| warning: false\nlibrary(broom)\nlibrary(tidyverse)\n```\n\n## Read the data\n\n```{r read-1}\nriver <- read_tsv(\n  file=\"../data/wolf-river-pollution.txt\",\n  col_names=TRUE,\n  col_types=\"cnn\")\nnames(river) <- tolower(names(river))\nglimpse(river)\n```\n## Question 1: Compare the average hcb concentrations between the surface, middepth and bottom sampling locations using analysis of variance. Be sure to include appropriate descriptive statistics and graphs. Comment on the assumptions needed for this test, but do not conduct any alternative analyses. If there is a statistically significant difference among the three means, use the Tukey post-hoc comparison to identify where the differences lie.\n\n## Draw boxplots for hcb concentrations\n\n```{r box-1}\n#| fig.width: 6\n#| fig.height: 2.5\nriver |>\n  ggplot(aes(depth, hcb)) +\n    geom_boxplot() +\n    xlab(\"River depth\") +\n    ylab(\"HCB concentration (units unknown)\") +\n    ggtitle(\"Graph drawn by Leroy Wheeler on 2024-10-23\") +\n    coord_flip()\n```\n\nHCB concentrations increase in the deeper parts of the river.  The variation is greater in the middepth and bottom of the river and looks skewed to the left (middepth) and to the right (bottom).\n\n\n\n## Descriptive statistics of hcb measurements\n\n```{r descriptives-1}\nriver |>\n  group_by(depth) |>\n  summarize(\n    hcb_mn=mean(hcb),\n    hcb_sd=sd(hcb),\n    n=n())\n```\n\nThe mid level and bottom samples have higher average concentrations and higher amounts of variability, with their standard deviation values about double that of the surface samples.  This difference in variation should not be a big problem in moving forward with looking for differences among the three groups.\n\n## Analysis of variance table for hcb\n\n```{r aov-1}\nm1 <- aov(hcb ~ depth, data=river)\ntidy(m1)\n```\n\nThe F-ratio is not large enough to suggest that there is a significant difference between any of the different group samples.  Additionally the p-value is greater than an alpha = 0.05. Therefore there is not enough evidence to reject the null hypothesis so we will conclude that hcb levels in the river is similar at all levels of depth.\n\n## Since there is no evidence for a significant difference in hcb in the three samples we do not conduct Pairwise tests, however I am curious to see what the TukeyHSD test tells us.\n\n```{r pairwise-1}\nTukeyHSD(m1)\n```\n\nTukey results are unnecessary because we failed to reject the null hypothesis.  Interestingly, TuckeyHSD also confirms there are no two group means which are statistically different.\n\n## Question 2: You want to run a sample size calculation for a replication of this experiment using hcb as the outcome measure. Assume that the sample means for hcb are similar at surface and middepth, but higher at the bottom (4.8 for the surface, 4.8 for middepth, and 5.2 for the bottom). What sample size would you need to achieve 90% power at an alpha level of 0.05.Sample size calculation scenario?\n\n\n## Sample size calculation for hcb, R code\n\n```{r sample-size}\nv <- var(c(4.8, 4.8, 5.2))\npower.anova.test(\n\tgroups=3,\n\tn=NULL,\n\tbetween.var=v,\n\twithin.var=1.10,\n\tsig.level=0.05,\n\tpower=0.90)\n```\n\n## Sample size calculation, interpretation\n\nA sample size of 132 measurements per depth level would provide 90% power for detecting a difference between means of 4.8, 4.8, and 5.2 in hcb concentration. This assumes that the variation within groups is similar to the previous study (1.10) and an alpha level of 0.05.\n\n","srcMarkdownNoYaml":"\n\nThis program reads data on the relationship sampling depth and two pollutant concentrations. Find more information in the [data dictionary][dd].\n\n[dd]: https://github.com/pmean/datasets/blob/master/wolf-river-pollution.yaml\n\nThis program was written by Steve Simon and Leroy Wheeler on 2024-10-23 and is placed in the public domain.\n\n## Load the tidyverse library\n\nFor most of your programs, you should load the tidyverse library. The messages and warnings are suppressed.\n\n```{r setup}\n#| message: false\n#| warning: false\nlibrary(broom)\nlibrary(tidyverse)\n```\n\n## Read the data\n\n```{r read-1}\nriver <- read_tsv(\n  file=\"../data/wolf-river-pollution.txt\",\n  col_names=TRUE,\n  col_types=\"cnn\")\nnames(river) <- tolower(names(river))\nglimpse(river)\n```\n## Question 1: Compare the average hcb concentrations between the surface, middepth and bottom sampling locations using analysis of variance. Be sure to include appropriate descriptive statistics and graphs. Comment on the assumptions needed for this test, but do not conduct any alternative analyses. If there is a statistically significant difference among the three means, use the Tukey post-hoc comparison to identify where the differences lie.\n\n## Draw boxplots for hcb concentrations\n\n```{r box-1}\n#| fig.width: 6\n#| fig.height: 2.5\nriver |>\n  ggplot(aes(depth, hcb)) +\n    geom_boxplot() +\n    xlab(\"River depth\") +\n    ylab(\"HCB concentration (units unknown)\") +\n    ggtitle(\"Graph drawn by Leroy Wheeler on 2024-10-23\") +\n    coord_flip()\n```\n\nHCB concentrations increase in the deeper parts of the river.  The variation is greater in the middepth and bottom of the river and looks skewed to the left (middepth) and to the right (bottom).\n\n\n\n## Descriptive statistics of hcb measurements\n\n```{r descriptives-1}\nriver |>\n  group_by(depth) |>\n  summarize(\n    hcb_mn=mean(hcb),\n    hcb_sd=sd(hcb),\n    n=n())\n```\n\nThe mid level and bottom samples have higher average concentrations and higher amounts of variability, with their standard deviation values about double that of the surface samples.  This difference in variation should not be a big problem in moving forward with looking for differences among the three groups.\n\n## Analysis of variance table for hcb\n\n```{r aov-1}\nm1 <- aov(hcb ~ depth, data=river)\ntidy(m1)\n```\n\nThe F-ratio is not large enough to suggest that there is a significant difference between any of the different group samples.  Additionally the p-value is greater than an alpha = 0.05. Therefore there is not enough evidence to reject the null hypothesis so we will conclude that hcb levels in the river is similar at all levels of depth.\n\n## Since there is no evidence for a significant difference in hcb in the three samples we do not conduct Pairwise tests, however I am curious to see what the TukeyHSD test tells us.\n\n```{r pairwise-1}\nTukeyHSD(m1)\n```\n\nTukey results are unnecessary because we failed to reject the null hypothesis.  Interestingly, TuckeyHSD also confirms there are no two group means which are statistically different.\n\n## Question 2: You want to run a sample size calculation for a replication of this experiment using hcb as the outcome measure. Assume that the sample means for hcb are similar at surface and middepth, but higher at the bottom (4.8 for the surface, 4.8 for middepth, and 5.2 for the bottom). What sample size would you need to achieve 90% power at an alpha level of 0.05.Sample size calculation scenario?\n\n\n## Sample size calculation for hcb, R code\n\n```{r sample-size}\nv <- var(c(4.8, 4.8, 5.2))\npower.anova.test(\n\tgroups=3,\n\tn=NULL,\n\tbetween.var=v,\n\twithin.var=1.10,\n\tsig.level=0.05,\n\tpower=0.90)\n```\n\n## Sample size calculation, interpretation\n\nA sample size of 132 measurements per depth level would provide 90% power for detecting a difference between means of 4.8, 4.8, and 5.2 in hcb concentration. This assumes that the variation within groups is similar to the previous study (1.10) and an alpha level of 0.05.\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","embed-resources":true,"output-file":"wheeler-5501-10-river.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","title":"Analysis of Wolf River pollution"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":[]}