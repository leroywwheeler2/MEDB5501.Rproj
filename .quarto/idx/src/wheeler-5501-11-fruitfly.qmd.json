{"title":"Analysis of fruitfly data","markdown":{"yaml":{"title":"Analysis of fruitfly data","format":{"html":{"embed-resources":true}}},"headingText":"Load the tidyverse library","containsRefs":false,"markdown":"\n\nThis program reads data on fruit fly longevity. Find more information in the [data dictionary][dd].\n\n[dd]: https://github.com/pmean/data/blob/master/files/fruitfly.yaml\n\nThis code was written by Steve Simon and Leroy Wheeler on 2024-10-29 and is placed in the public domain.\n\n\n```{r setup}\n#| message: false\n#| warning: false\nlibrary(broom)\nlibrary(tidyverse)\n```\n\nFor most of your programs, you should load the tidyverse library. The broom library converts your output to a nicely arranged dataframe. The messages and warnings are suppressed.\n\n## List the variable names\n\n```{r variable-list}\nfn <- \"https://jse.amstat.org/datasets/fruitfly.dat.txt\"\nvlist <- c(\n  \"id\",\n  \"partners\",\n  \"type\",\n  \"longevity\",\n  \"thorax\",\n  \"sleep\")\n```\n\nWhen a dataset does not have variables on the first line, you need to specify them in the code.\n\n## Read the data and view a brief summary\n\n```{r read}\nfly <- read_fwf(\n  \"../data/fruitfly.txt\",\n  col_types=\"nnnnnn\",\n  fwf_widths(\n    widths=c(2, 2, 2, 3, 5, 3),\n    col_names=vlist))\nglimpse(fly)\n```\n\nThe fruitfly dataset has a fixed width format (fwf). You need to specify the columns that each variable uses.\n\n## Create cage groups\n\n```{r cage}\nfly$cage <- \n  case_when(\n    fly$partners==0 & fly$type==9 ~ \"No females\",\n    fly$partners==1 & fly$type==0 ~ \"One pregnant female\",\n    fly$partners==1 & fly$type==1 ~ \"One virgin female\",\n    fly$partners==8 & fly$type==0 ~ \"Eight pregnant females\",\n    fly$partners==8 & fly$type==1 ~ \"Eight virgin females\")\n```\n\nThe five categories represent different combinations of partners and type.\n\n## Question 1: Review the fruitfly analysis discussed in this module. There is a second variable, sleep, that might be influenced by the presence or absence of virgin or pregnant females. Compute descriptive statistics for sleep levels in each of the five groups. Interpret these statistics\n\n```{r sleep-means}\nfly |>\n  group_by(cage) |>\n  summarize(\n    sleep_mn=mean(sleep),\n    sleep_sd=sd(sleep),\n    n=n())\n```\n\nThe mean sleep time is similar among all groups but the cage containing eight virgin females might be a little low compared to the others. The standard deviations are consistent across all groups and off by no more than a factor of 2.\n\n## Question 2: Draw a boxplot for sleep levels in each group. Interpret the boxplots.\n\n```{r longevity-boxplot}\n#| fig.width: 6\n#| fig.height: 2.5\nfly |>\n  ggplot(aes(cage, sleep)) +\n    geom_boxplot() +\n    ggtitle(\"Graph drawn by Leroy Wheeler on 2024-10-30\") +\n    xlab(\"Cage residents\") +\n    ylab(\"Sleep (% of the day)\") +\n    coord_flip()\n```\n\nThe boxplot also shows distribution of sleep time of the males in the different cages. The distributions vary of sleep time varies quite a bit in the different groups and there are some cages with significant outliers.\n\n## Question 3: Based on the previous two questions, do you believe that the assumptions of analysis of variance are met. Proceed with all of the remaining questions regardless of your conclusion here.\n\nThe assumptions of ANOVA require normal distribution, equal variance and independence of sample data.  From the box plots we see some deviance from perfect normality but we see no more than a 2-fold difference in standard deviations between any two groups.  Outliers to the right suggest that a log transformation before conducting ANOVA might be helpful.  We will also assume independence between the samples.\n\n## Question 4: Conduct a single factor analysis of variance, using sleep as the dependent variable and cage as the categorical predictor variable. Print an analysis of variance table. Interpret the F-ratio and the p-value.\n\n```{r longevity-one-factor-anova}\nm1 <- aov(sleep ~ cage, data=fly)\ntidy(m1)\n```\n\nThe F-ratio is less than one and the p-value is greater than our alpha of 0.05. We conclude that there is no \ndifference among the population mean sleep time.\n\n## Question 5: Calculate and interpret confidence intervals using the Tukey post hoc comparisons. Which intervals include 0 and which do not. Provide a general conclusion about which groups, if any, differ from one another.\n\n\n```{r sleep-anova-2}\nt3 <- TukeyHSD(m1, ordered=TRUE)\nt3\n```\nAll 95% confidence intervals have a lower value that is negative and an upper value which is positive which means that a zero value in the difference between each group is a distinct possibility.  Additionally all the p values are large.  With this information and from the previous ANOVA test, we conclude that all groups have similar sleep times.\n\n\n## Question 6: Conduct a Kruskal-Wallis test. Interpret your results.\n\n```{r kw}\nkruskal.test(sleep ~ cage, data=fly)\n```\n\nThe chi-squared value is not greater than the df = 4 value and the p value is greater than our alpha =0.05 so we conclude there is no difference in sleep time using the Kruskal-Wallis rank sum test.\n\n","srcMarkdownNoYaml":"\n\nThis program reads data on fruit fly longevity. Find more information in the [data dictionary][dd].\n\n[dd]: https://github.com/pmean/data/blob/master/files/fruitfly.yaml\n\nThis code was written by Steve Simon and Leroy Wheeler on 2024-10-29 and is placed in the public domain.\n\n## Load the tidyverse library\n\n```{r setup}\n#| message: false\n#| warning: false\nlibrary(broom)\nlibrary(tidyverse)\n```\n\nFor most of your programs, you should load the tidyverse library. The broom library converts your output to a nicely arranged dataframe. The messages and warnings are suppressed.\n\n## List the variable names\n\n```{r variable-list}\nfn <- \"https://jse.amstat.org/datasets/fruitfly.dat.txt\"\nvlist <- c(\n  \"id\",\n  \"partners\",\n  \"type\",\n  \"longevity\",\n  \"thorax\",\n  \"sleep\")\n```\n\nWhen a dataset does not have variables on the first line, you need to specify them in the code.\n\n## Read the data and view a brief summary\n\n```{r read}\nfly <- read_fwf(\n  \"../data/fruitfly.txt\",\n  col_types=\"nnnnnn\",\n  fwf_widths(\n    widths=c(2, 2, 2, 3, 5, 3),\n    col_names=vlist))\nglimpse(fly)\n```\n\nThe fruitfly dataset has a fixed width format (fwf). You need to specify the columns that each variable uses.\n\n## Create cage groups\n\n```{r cage}\nfly$cage <- \n  case_when(\n    fly$partners==0 & fly$type==9 ~ \"No females\",\n    fly$partners==1 & fly$type==0 ~ \"One pregnant female\",\n    fly$partners==1 & fly$type==1 ~ \"One virgin female\",\n    fly$partners==8 & fly$type==0 ~ \"Eight pregnant females\",\n    fly$partners==8 & fly$type==1 ~ \"Eight virgin females\")\n```\n\nThe five categories represent different combinations of partners and type.\n\n## Question 1: Review the fruitfly analysis discussed in this module. There is a second variable, sleep, that might be influenced by the presence or absence of virgin or pregnant females. Compute descriptive statistics for sleep levels in each of the five groups. Interpret these statistics\n\n```{r sleep-means}\nfly |>\n  group_by(cage) |>\n  summarize(\n    sleep_mn=mean(sleep),\n    sleep_sd=sd(sleep),\n    n=n())\n```\n\nThe mean sleep time is similar among all groups but the cage containing eight virgin females might be a little low compared to the others. The standard deviations are consistent across all groups and off by no more than a factor of 2.\n\n## Question 2: Draw a boxplot for sleep levels in each group. Interpret the boxplots.\n\n```{r longevity-boxplot}\n#| fig.width: 6\n#| fig.height: 2.5\nfly |>\n  ggplot(aes(cage, sleep)) +\n    geom_boxplot() +\n    ggtitle(\"Graph drawn by Leroy Wheeler on 2024-10-30\") +\n    xlab(\"Cage residents\") +\n    ylab(\"Sleep (% of the day)\") +\n    coord_flip()\n```\n\nThe boxplot also shows distribution of sleep time of the males in the different cages. The distributions vary of sleep time varies quite a bit in the different groups and there are some cages with significant outliers.\n\n## Question 3: Based on the previous two questions, do you believe that the assumptions of analysis of variance are met. Proceed with all of the remaining questions regardless of your conclusion here.\n\nThe assumptions of ANOVA require normal distribution, equal variance and independence of sample data.  From the box plots we see some deviance from perfect normality but we see no more than a 2-fold difference in standard deviations between any two groups.  Outliers to the right suggest that a log transformation before conducting ANOVA might be helpful.  We will also assume independence between the samples.\n\n## Question 4: Conduct a single factor analysis of variance, using sleep as the dependent variable and cage as the categorical predictor variable. Print an analysis of variance table. Interpret the F-ratio and the p-value.\n\n```{r longevity-one-factor-anova}\nm1 <- aov(sleep ~ cage, data=fly)\ntidy(m1)\n```\n\nThe F-ratio is less than one and the p-value is greater than our alpha of 0.05. We conclude that there is no \ndifference among the population mean sleep time.\n\n## Question 5: Calculate and interpret confidence intervals using the Tukey post hoc comparisons. Which intervals include 0 and which do not. Provide a general conclusion about which groups, if any, differ from one another.\n\n\n```{r sleep-anova-2}\nt3 <- TukeyHSD(m1, ordered=TRUE)\nt3\n```\nAll 95% confidence intervals have a lower value that is negative and an upper value which is positive which means that a zero value in the difference between each group is a distinct possibility.  Additionally all the p values are large.  With this information and from the previous ANOVA test, we conclude that all groups have similar sleep times.\n\n\n## Question 6: Conduct a Kruskal-Wallis test. Interpret your results.\n\n```{r kw}\nkruskal.test(sleep ~ cage, data=fly)\n```\n\nThe chi-squared value is not greater than the df = 4 value and the p value is greater than our alpha =0.05 so we conclude there is no difference in sleep time using the Kruskal-Wallis rank sum test.\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","embed-resources":true,"output-file":"wheeler-5501-11-fruitfly.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","title":"Analysis of fruitfly data"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":[]}