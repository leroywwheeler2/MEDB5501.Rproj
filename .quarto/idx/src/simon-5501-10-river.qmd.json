{"title":"Analysis of Wolf River pollution","markdown":{"yaml":{"title":"Analysis of Wolf River pollution","format":{"html":{"embed-resources":true}}},"headingText":"Load the tidyverse library","containsRefs":false,"markdown":"\n\nThis program reads data on the relationship sampling depth and two pollutant concentrations. Find more information in the [data dictionary][dd].\n\n[dd]: https://github.com/pmean/datasets/blob/master/wolf-river-pollution.yaml\n\nThis program was written by Steve Simon on 2024-10-20 and is placed in the public domain.\n\n\nFor most of your programs, you should load the tidyverse library. The messages and warnings are suppressed.\n\n```{r setup}\n#| message: false\n#| warning: false\nlibrary(broom)\nlibrary(tidyverse)\n```\n\n## Read the data\n\n```{r read-1}\nriver <- read_tsv(\n  file=\"../data/wolf-river-pollution.txt\",\n  col_names=TRUE,\n  col_types=\"cnn\")\nnames(river) <- tolower(names(river))\nglimpse(river)\n```\n\n## Draw boxplots\n\n```{r box-1}\n#| fig.width: 6\n#| fig.height: 2.5\nriver |>\n  ggplot(aes(depth, aldrin)) +\n    geom_boxplot() +\n    xlab(\"River depth\") +\n    ylab(\"Aldrin concentration\") +\n    ggtitle(\"Graph drawn by Steve Simon on 2024-10-20\") +\n    coord_flip()\n```\n\nThe deeper you sample, the higher the concentration of Aldrin. The variation also increases as you go deeper. There are some minor deviations from normality, but nothing too serious.\n\n## Descriptive statistics\n\n```{r descriptives-1}\nriver |>\n  group_by(depth) |>\n  summarize(\n    aldrin_mn=mean(aldrin),\n    aldrin_sd=sd(aldrin),\n    n=n())\n```\n\nThe bottom samples have the highest average concentration and the highest amount of variability.\n\n## Analysis of variance table\n\n```{r aov-1}\nm1 <- aov(aldrin ~ depth, data=river)\ntidy(m1)\n```\n\nThe F-ratio is large and the p-value is less than alpha. You should reject the null hypothesis and conclude that at least two means differ from one another.\n\n## Pairwise tests\n\n```{r pairwise-1}\nTukeyHSD(m1)\n```\n\nThere is a statistically significant difference in average concentration of Aldrin between the surface measurements and the bottom measurements. The confidence interval, however, is very wide, indicating a large amount of sampling error. \n\nAlthough the average middepth measurements are larger than the surface measurements and smaller than the bottom measurements, the difference of about 0.8 to 1.0 units is not statistically significant.\n\n## Sample size calculation scenario\n\nYou want to replicate this study at a different site and want a lot more precision and power. If the amount of sampling error (mean squared within) is similar, and the populations means are very close (4.8 for the surface, 5.0 for the middepth, and 5.2 for the bottom), what sample size would you need to achieve 90% power with an alpha level of 0.05?\n\n## Sample size calculation, R code\n\n```{r sample-size}\nv <- var(c(4.8, 5.0, 5.2))\npower.anova.test(\n\tgroups=3,\n\tn=NULL,\n\tbetween.var=v,\n\twithin.var=1.39,\n\tsig.level=0.05,\n\tpower=0.90)\n```\n\n## Sample size calculation, interpretation\n\nA sample size of 221 measurements per depth level would provide 90% power for detecting a difference between means of 4.8, 5.0, and 5.2 in aldrin concentration. This assumes that the variation within groups is similar to the previous study (1.39) and an alpha level of 0.05.\n\n## Recalculate sample size, new scenario\n\nThere is no way in heaven or earth that you can afford to make 221 measurements at each depth. So give up the idea that you can detect changes in means across such a narrow range. Suppose that you want to be able to detect differences among means that are 4.5, 5.0, and 5.5. If you could live with that and if everything remains the same, what sample size would you need?\n\n## Recalculate sample size, R code\n\n```{r recalculate}\nv <- var(c(4.5, 5.0, 5.5))\npower.anova.test(\n\tgroups=3,\n\tn=NULL,\n\tbetween.var=v,\n\twithin.var=1.39,\n\tsig.level=0.05,\n\tpower=0.90)\n```\n\n## Recalculate sample size, interpretation. \n\nMuch better! A sample size of 37 measurements per depth level would provide 90% power for detecting a difference between means of 4.5, 5.0, and 5.5 in aldrin concentration. This assumes that the variation within groups is similar to the previous study (1.39) and an alpha level of 0.05.\n","srcMarkdownNoYaml":"\n\nThis program reads data on the relationship sampling depth and two pollutant concentrations. Find more information in the [data dictionary][dd].\n\n[dd]: https://github.com/pmean/datasets/blob/master/wolf-river-pollution.yaml\n\nThis program was written by Steve Simon on 2024-10-20 and is placed in the public domain.\n\n## Load the tidyverse library\n\nFor most of your programs, you should load the tidyverse library. The messages and warnings are suppressed.\n\n```{r setup}\n#| message: false\n#| warning: false\nlibrary(broom)\nlibrary(tidyverse)\n```\n\n## Read the data\n\n```{r read-1}\nriver <- read_tsv(\n  file=\"../data/wolf-river-pollution.txt\",\n  col_names=TRUE,\n  col_types=\"cnn\")\nnames(river) <- tolower(names(river))\nglimpse(river)\n```\n\n## Draw boxplots\n\n```{r box-1}\n#| fig.width: 6\n#| fig.height: 2.5\nriver |>\n  ggplot(aes(depth, aldrin)) +\n    geom_boxplot() +\n    xlab(\"River depth\") +\n    ylab(\"Aldrin concentration\") +\n    ggtitle(\"Graph drawn by Steve Simon on 2024-10-20\") +\n    coord_flip()\n```\n\nThe deeper you sample, the higher the concentration of Aldrin. The variation also increases as you go deeper. There are some minor deviations from normality, but nothing too serious.\n\n## Descriptive statistics\n\n```{r descriptives-1}\nriver |>\n  group_by(depth) |>\n  summarize(\n    aldrin_mn=mean(aldrin),\n    aldrin_sd=sd(aldrin),\n    n=n())\n```\n\nThe bottom samples have the highest average concentration and the highest amount of variability.\n\n## Analysis of variance table\n\n```{r aov-1}\nm1 <- aov(aldrin ~ depth, data=river)\ntidy(m1)\n```\n\nThe F-ratio is large and the p-value is less than alpha. You should reject the null hypothesis and conclude that at least two means differ from one another.\n\n## Pairwise tests\n\n```{r pairwise-1}\nTukeyHSD(m1)\n```\n\nThere is a statistically significant difference in average concentration of Aldrin between the surface measurements and the bottom measurements. The confidence interval, however, is very wide, indicating a large amount of sampling error. \n\nAlthough the average middepth measurements are larger than the surface measurements and smaller than the bottom measurements, the difference of about 0.8 to 1.0 units is not statistically significant.\n\n## Sample size calculation scenario\n\nYou want to replicate this study at a different site and want a lot more precision and power. If the amount of sampling error (mean squared within) is similar, and the populations means are very close (4.8 for the surface, 5.0 for the middepth, and 5.2 for the bottom), what sample size would you need to achieve 90% power with an alpha level of 0.05?\n\n## Sample size calculation, R code\n\n```{r sample-size}\nv <- var(c(4.8, 5.0, 5.2))\npower.anova.test(\n\tgroups=3,\n\tn=NULL,\n\tbetween.var=v,\n\twithin.var=1.39,\n\tsig.level=0.05,\n\tpower=0.90)\n```\n\n## Sample size calculation, interpretation\n\nA sample size of 221 measurements per depth level would provide 90% power for detecting a difference between means of 4.8, 5.0, and 5.2 in aldrin concentration. This assumes that the variation within groups is similar to the previous study (1.39) and an alpha level of 0.05.\n\n## Recalculate sample size, new scenario\n\nThere is no way in heaven or earth that you can afford to make 221 measurements at each depth. So give up the idea that you can detect changes in means across such a narrow range. Suppose that you want to be able to detect differences among means that are 4.5, 5.0, and 5.5. If you could live with that and if everything remains the same, what sample size would you need?\n\n## Recalculate sample size, R code\n\n```{r recalculate}\nv <- var(c(4.5, 5.0, 5.5))\npower.anova.test(\n\tgroups=3,\n\tn=NULL,\n\tbetween.var=v,\n\twithin.var=1.39,\n\tsig.level=0.05,\n\tpower=0.90)\n```\n\n## Recalculate sample size, interpretation. \n\nMuch better! A sample size of 37 measurements per depth level would provide 90% power for detecting a difference between means of 4.5, 5.0, and 5.5 in aldrin concentration. This assumes that the variation within groups is similar to the previous study (1.39) and an alpha level of 0.05.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","embed-resources":true,"output-file":"simon-5501-10-river.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","title":"Analysis of Wolf River pollution"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":[]}