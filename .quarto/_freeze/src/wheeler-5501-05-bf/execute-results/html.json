{
  "hash": "b59887a28a5ac0de996fcd1e0572ded6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Analysis of breast feeding study\"\nauthor: \"Steve Simon and Leroy Wheeler\"\nformat: \n  html:\n    embed-resources: true\ndate: 2024-09-18\n---\n\n\nThis program reads data and fits various linear regression models on a breast feeding study in pre-term infants.  Find more information in the [data dictionary][dd]. This code is placed in the public domain.\n\n[dd]: https://raw.githubusercontent.com/pmean/datasets/master/breast-feeding-preterm.yaml\n\n## Load the tidyverse library\n\nFor most of your programs, you should load the tidyverse library. The messages and warnings are suppressed.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(broom)\nlibrary(tidyverse)\n```\n:::\n\n\n## Read the data and view a brief summary\n\nUse the read_csv function to read the data. With a large number of variables, you may choose to leave the col_types out.R will usually figure out which variables are numeric and which are strings.\n\nReplace all the numeric codes of -1 with the missing value code (NA).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbf <- read_csv(\n  file=\"../data/breast-feeding-preterm.csv\",\n  col_names=TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nRows: 84 Columns: 30\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): feed_type, race\ndbl (28): age_stop, sepsis, total_ab, del_type, mom_age, gravida, para, mar_...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n\n\n:::\n\n```{.r .cell-code}\nglimpse(bf)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 84\nColumns: 30\n$ feed_type <chr> \"Treatmen\", \"Treatmen\", \"Control\", \"Treatmen\", \"Control\", \"C…\n$ age_stop  <dbl> 30, 4, 12, 29, 24, 24, 27, 5, 32, 20, 24, 5, 16, 10, 16, 18,…\n$ sepsis    <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, …\n$ total_ab  <dbl> 221, 12, 88, 108, 0, 3, 5, 219, 391, 51, 72, 26, 628, 68, 47…\n$ del_type  <dbl> 2, 2, 1, 2, 2, 1, 2, 1, 2, 2, 2, 2, 1, 1, 2, 2, 1, 1, 1, 2, …\n$ mom_age   <dbl> 30, 19, 37, 29, 23, 23, 29, 20, 40, 27, 40, 26, 33, 29, 32, …\n$ gravida   <dbl> 2, 1, 3, 3, 1, 1, 2, 2, 2, 2, 3, 2, 3, 5, 3, 1, 1, 1, 2, 1, …\n$ para      <dbl> 1, 1, 3, 1, 2, 2, 1, 2, 2, 1, 1, 2, 3, 3, 2, 1, 2, 2, 2, 2, …\n$ mar_st    <dbl> 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ race      <chr> \"W\", \"W\", \"W\", \"W\", \"W\", \"W\", \"W\", \"W\", \"W\", \"W\", \"W\", \"W\", …\n$ smoker    <dbl> 2, 1, 1, 2, 2, 2, 2, 1, 2, 2, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, …\n$ mi_hosp   <dbl> 10, NA, 8, 90, 25, 25, 15, 30, 13, 15, 12, 25, 10, 75, 10, 5…\n$ ng_tube   <dbl> 39, 13, 14, 32, 4, 11, 15, 30, 54, 31, 27, 10, 43, 26, 7, 30…\n$ tot_bott  <dbl> 0, 68, 92, 0, 20, 65, 33, 152, 0, 13, 54, 39, 94, 100, 41, 0…\n$ bw        <dbl> 1.738, 1.710, 1.955, 1.730, 2.050, 1.656, 1.735, 1.160, 1.39…\n$ gest_age  <dbl> 31, 34, 32, 31, 35, 35, 34, 30, 29, 32, 32, 34, 29, 32, 32, …\n$ apgar1    <dbl> 8, 7, 6, 7, 8, 6, 2, 6, 8, 7, 7, 7, 6, 4, 8, 8, 8, 8, 1, 8, …\n$ apgar5    <dbl> 9, 8, 8, 9, 9, 9, 5, 8, 9, 8, 7, 8, 9, 8, 9, 9, 9, 9, 7, 9, …\n$ bf1_wt    <dbl> 1.575, 1.676, 1.947, 1.615, 2.025, 1.665, 1.695, NA, 1.445, …\n$ bf1_age   <dbl> 9, 11, 12, 16, 1, 1, 7, NA, 27, 3, 7, 5, 28, 8, 10, 8, 34, 3…\n$ dc_wt     <dbl> 2.610, 2.048, 2.425, 2.125, 1.980, 1.995, 1.995, 2.245, 2.10…\n$ dc_age    <dbl> 46, 26, 32, 38, 8, 18, 22, 53, 57, 34, 32, 17, 58, 44, 19, 3…\n$ dc3_wt    <dbl> 2.665, 2.048, 3.005, 2.130, 2.136, 3.454, 1.996, 2.245, 2.69…\n$ bf0       <dbl> 1, 4, 2, 1, 2, 2, 2, 4, 1, 1, 1, 2, 1, 2, 1, 1, 4, 4, 1, 1, …\n$ bf1       <dbl> 1, 4, 1, 1, 2, 2, 1, 4, 1, 1, 2, 2, 2, 2, 1, 1, 4, 4, 1, 1, …\n$ bf2       <dbl> 1, 4, 2, 1, 2, 2, 1, 4, 1, 1, 2, 4, 2, 2, 1, 2, 4, 4, 1, 1, …\n$ bf3       <dbl> 1, 4, 2, 1, 2, 2, 1, 4, 1, 2, 2, 4, 2, 4, 2, 2, 4, 4, 1, 1, …\n$ bf4       <dbl> 1, 4, 4, 1, 2, 2, 1, 4, 1, 4, 2, 4, 4, 4, 4, 4, 4, 4, 1, 2, …\n$ feed_cod  <dbl> 1, 1, 0, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 0, …\n$ feed_rev  <dbl> 0, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, …\n```\n\n\n:::\n:::\n\n\n## Convert -1 to NA\n\nThe code below only works because every single variable in the dataset is non-negative.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbf[bf==-1] <- NA\n```\n:::\n\n\n## Question 1: Calculate descriptive statistics for gestational age (mean, standard deviation, minimum, and maximum) and count the number of missing values. Interpret these results.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbf |>\n\tsummarize(\n\t\tmean_gest_age=mean(gest_age, na.rm=TRUE),\n\t\tsd_gest_age=sd(gest_age, na.rm=TRUE),\n\t\tmin_gest_age=min(gest_age, na.rm=TRUE),\n\t\tmax_gest_age=max(gest_age, na.rm=TRUE),\n\t\tn_missing=sum(is.na(gest_age))) |>\n\tdata.frame()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  mean_gest_age sd_gest_age min_gest_age max_gest_age n_missing\n1      31.84524    2.026892           26           35         0\n```\n\n\n:::\n:::\n\n\nThis is a reasonable distribution of infants who are born early. The youngest pre-term infant was 26 weeks old with the oldest pre-term infant being 35 weeks of age.  There are no missing data for this variable in this data set.\n\n## Question 2: Calculate descriptive statistics for age at discharge from the hospital and count the number of missing values. Interpet these results.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbf |>\n\tsummarize(\n\t\tmean_dc_age=mean(dc_age, na.rm=TRUE),\n\t\tsd_dc_age=sd(dc_age, na.rm=TRUE),\n\t\tmin_dc_age=min(dc_age, na.rm=TRUE),\n\t\tmax_dc_age=max(dc_age, na.rm=TRUE),\n\t\tn_missing=sum(is.na(dc_age))) |>\n\tdata.frame()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  mean_dc_age sd_dc_age min_dc_age max_dc_age n_missing\n1    33.72619  17.25385          8         77         0\n```\n\n\n:::\n:::\n\nThe average age of the infants discharged from the hospital was about 34 days, with a minimum value of 8 days and a maximum value of 77 days. These are expected values as infants who are pre-term often have to remain in the hospital after they are born. There are no missing values for this variable in this data set.\n\n\n## Question 3: Pre-term infants spend a longer amount of time in the hospital than full-term infants. In fact, the earlier the baby appears, the longer the amount of time that the infant remains in the birth hospital. Draw a scatterplot to examine whether this pattern holds in this dataset. Consider age at discharge to be the outcome variable when deciding how to draw this scatterplot. Use the geom_smooth function to graph the regression line, but do not extend the line beyond the range of the data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbf |>\n\tggplot(aes(gest_age, dc_age)) +\n\t  geom_point() +\n\t  xlab(\"Estimated gestational age (weeks)\") +\n\t  ylab(\"Age at discharge (days)\") +\n    geom_smooth(method=\"lm\", se=FALSE) +\n    ggtitle(\"Plot produced by Leroy Wheeler on 2024-09-18\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](wheeler-5501-05-bf_files/figure-html/plot-1.png){width=672}\n:::\n:::\n\n\nOur data set here is consistent with previous observations that infants with a younger estimated gestational age at birth must spend more time in the hospital before being discharged.  \n\n\n## Question 4: Use the lm function to compute the slope and intercept for the regression model predicting age at discharge using gestational age. Interpret both the slope and the intercept and state whether the intercept represents an inappropriate extrapoloation.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(dc_age~gest_age, data=bf)\nm1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = dc_age ~ gest_age, data = bf)\n\nCoefficients:\n(Intercept)     gest_age  \n    272.206       -7.489  \n```\n\n\n:::\n:::\n\nWe can see from the slope of the regression model, for every week early that the infant is born, she has to spend an additional 7.5 days in the hospital before being discharge.  The y-intercept is well out of the range of data because no infants will be able to survive outside the womb at a gestational age of zero.  The y-intercept is therefore meaningless.\n\n## Question 5: Calculate an analysis of variance table for this regression model. Interpret the F ratio and the p-value. What hypothesis do these two statistics test?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: dc_age\n          Df  Sum Sq Mean Sq F value    Pr(>F)    \ngest_age   1 19122.9 19122.9  280.72 < 2.2e-16 ***\nResiduals 82  5585.8    68.1                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\nThe F-ratio is very large and the p-value is extremely small, so we will reject the null hypothesis and conclude that there is strong evidence for a linear relationship between gestational age of the infant and age of the infant at discharge from the hospital.\n\n\n## Question 6: Calculate R squared for this regression model. Interpret this value. R-squared for dc_age.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglance(m1)$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.773932\n```\n\n\n:::\n:::\n\n\nWe see that approximately 78% of the extra time remaining in the hospital is due to the gestational age of the infant at birth.  Therefore we conclude that the inverse relationship observed when we graph gestation age of the infant vs the age of the infant at discharge is strong.\n\n## Question 7: Compute a confidence interval for the slope parameter. Interpret this interval. Characterize the interval as either narrow or wide.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nconfint(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                2.5 %     97.5 %\n(Intercept) 243.83418 300.577438\ngest_age     -8.37785  -6.599561\n```\n\n\n:::\n:::\n\n\nThe 95% confidence interval includes only negative values consistent with the inverse relationship between gestational age at birth and time remaining in the hospital after birth.  We are therefore 95% confident that the time spent in the hospital after birth decreases somewhere between 6.6 and 8.4 days for every additional gestational week of age that the infant has at the time of birth. The slope of the regression line has a narrow range between -6.6 days and -8.4 days spent in the hospital per an additional week of gestational age at birth.\n\n## Alternate test for the slope parameter\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntidy(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)   272.      14.3        19.1 6.59e-32\n2 gest_age       -7.49     0.447     -16.8 3.32e-28\n```\n\n\n:::\n:::\n\n\nThe T statistic is testing the slope parameter is large and the p-value is small, both indicating that you should reject the null hypothesis and conclude that there is a negative relationship the infants gestational age and its age at the time of discharge from the hospital.\n",
    "supporting": [
      "wheeler-5501-05-bf_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}