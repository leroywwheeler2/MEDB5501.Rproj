{
  "hash": "4916ba69ec38135dd7a485416f944979",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Analysis of Salary data by graduates from 706 universities in the United States\"\nformat: \n  html:\n    embed-resources: true\nexecute:\n  error: true\n---\n\n\n\n\nThis program was written by Leroy Wheeler with guidance from Dr. Steve Simon on 2024-10-25. It is placed in the public domain.\n\n\n## Libraries\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(broom)\nlibrary(tidyverse)\n```\n:::\n\n\n\n## Read data https://dasl.datadescription.com/datafile/earnings/\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nearnings <- read_tsv(\n  file=\"../data/earnings.txt\",\n  col_types=\"ccnnnnnnnnc\")\nnames(earnings) <- tolower(names(earnings))\nglimpse(earnings)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 706\nColumns: 11\n$ school           <chr> \"Princeton University\", \"University of Michigan-Ann A…\n$ place            <chr> \"Princeton, NJ\", \"Ann Arbor, MI\", \"Cambridge, MA\", \"H…\n$ price            <dbl> 61300, 28100, 64800, 58600, 35700, 18500, 66600, 6280…\n$ `price with aid` <dbl> 20600, 17300, 16500, 22400, 18200, 13400, 16000, 1900…\n$ pct.need         <dbl> 59, 30, 58, 39, 51, 39, 58, 32, 27, 48, 56, 50, 37, 5…\n$ `merit aided`    <dbl> NA, 16, NA, 11, 6, 24, NA, 55, 3, NA, NA, NA, 6, 2, 6…\n$ earn             <dbl> 62800, 59000, 62900, 63700, 60300, 51800, 53400, 6320…\n$ sat              <dbl> 1510, 1380, 1510, 1460, 1360, 1260, 1440, 1360, 1360,…\n$ act              <dbl> 33, 30, 34, 33, 30, 29, 32, 31, 31, 33, 34, 34, 26, 2…\n$ `sat/act`        <dbl> 1510, 1380, 1510, 1460, 1360, 1260, 1440, 1360, 1360,…\n$ public           <chr> \"0\", \"1\", \"0\", \"0\", \"1\", \"1\", \"1\", \"0\", \"1\", \"0\", \"0\"…\n```\n\n\n:::\n:::\n\n\n\n\n## Descriptive statistics of salary of graduates\n\n\n::: {.cell}\n\n```{.r .cell-code}\nearnings |>\n  summarise(\n    earn_mn=mean(earn, na.rm=TRUE),\n    earn_sd=sd(earn, na.rm=TRUE),\n    earn_min=min(earn, na.rm=TRUE),\n    earn_max=max(earn, na.rm=TRUE),\n    n_missing=sum(is.na(earn)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 5\n  earn_mn earn_sd earn_min earn_max n_missing\n    <dbl>   <dbl>    <dbl>    <dbl>     <int>\n1  45598.   6724.    28300    79700         0\n```\n\n\n:::\n:::\n\n\n## Descriptive statistics of price paid for degree\n\n\n::: {.cell}\n\n```{.r .cell-code}\nearnings |>\n  summarise(\n    price_mn=mean(price, na.rm=TRUE),\n    price_sd=sd(price, na.rm=TRUE),\n    price_min=min(price, na.rm=TRUE),\n    price_max=max(price, na.rm=TRUE),\n    n_missing=sum(is.na(price)))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 5\n  price_mn price_sd price_min price_max n_missing\n     <dbl>    <dbl>     <dbl>     <dbl>     <int>\n1   42200.   15727.     16500     70400         0\n```\n\n\n:::\n:::\n\n\n\n\n## Hypothesis:\n\n##\tH0: β1 = 0 →  No relationship between price of degree and salary earned \n\n##\tHa: β1 ≠ 0 →  A relationship exists between price of degree and salary earned\n\n\n::: {.cell}\n\n```{.r .cell-code}\nearnings|>\n\tggplot(aes(price, earn)) +\n\t  geom_point() +\n\t  xlab(\"Price of College Degree (USD)\") +\n\t  ylab(\"Salary After Graduation (USD)\") +\n    geom_smooth(method=\"lm\", se=FALSE) +\n    ggtitle(\"Scatter Plot of Salary vs College Price tag [Leroy Wheeler 2024-10-20]\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](wheeler-5501-15-earnings_files/figure-html/plot 1-1.png){width=672}\n:::\n:::\n\n\n\nThere appears to be a small positive linear relationship between price paid for college degree and the salary earned by college graduates.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(earn~price, data=earnings)\nm1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = earn ~ price, data = earnings)\n\nCoefficients:\n(Intercept)        price  \n  4.042e+04    1.227e-01  \n```\n\n\n:::\n:::\n\n\nThe linear regression model predicts that for every additional dollar spent on the college degree, the graduates with that degree would expect to earn an additional 12 cents per year in salary.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: earn\n           Df     Sum Sq    Mean Sq F value    Pr(>F)    \nprice       1 2.6244e+09 2624415359  63.166 7.552e-15 ***\nResiduals 704 2.9250e+10   41547620                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglance(m1)$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.08233734\n```\n\n\n:::\n:::\n\n\nWith an R squared value of 0.08, we conclude that the relationship between price paid for college degree and the salary earned upon graduation is very weak.  The ANOVA table displays a large F value and a small p-value for our linear regression model, therefore we conclude that this weak relationship is likely true.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 |>\n  ggplot(aes(price, .resid)) + \n    geom_point() +\n\t  ggtitle(\"Scatter of Residuals drawn by Leroy Wheeler on 2024-10-25\") +\n\t  xlab(\"Price of College Degree (USD)\") +\n\t  ylab(\"Residuals from m1\") \n```\n\n::: {.cell-output-display}\n![](wheeler-5501-15-earnings_files/figure-html/residual-scatterplot-1-1.png){width=672}\n:::\n:::\n\n\n\nThis scatterplot displays the residual variation according to college price. It looks like there is some non-linearity in the data towards the more expensive schools.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 |>\n  ggplot(aes(.resid)) +\n    geom_histogram(\n      binwidth=2000,\n      color=\"black\",\n      fill=\"white\") +\n\t  ggtitle(\"Residual histogram drawn by Leroy Wheeler on 2024-10-25\") +\n\t  xlab(\"Residuals from m1\")\n```\n\n::: {.cell-output-display}\n![](wheeler-5501-15-earnings_files/figure-html/histogram-1-1.png){width=672}\n:::\n:::\n\n\nA plot of the residuals demonstrates a little right skew in the residuals.  This linear model may be improved by a log transformation, however with our large sample size (n = 706), we should be able to safely ignore a little departure from normal distribution.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nearnings |>\n  ggplot(aes(public, price)) +\n    geom_boxplot() +\n    ggtitle(\"Graph drawn by Leroy Wheeler on 2024-10-22\") +\n    xlab(\"Public University\") +\n    ylab(\"Price paid for college degree (USD)\") +\n    coord_flip()\n```\n\n::: {.cell-output-display}\n![](wheeler-5501-15-earnings_files/figure-html/box plot-1-1.png){width=672}\n:::\n:::\n\n\nThe box plots show more variation in the price data in the private university attendees when compared to the public university attendees.  We need some descriptive statistics to compare their standard deviations.\n\n\n## Descriptive statistics for price paid for college degree when distinguished by whether the graduates attended a private or public university\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nearnings |>\n  group_by(public) |>\n  summarize(\n    Price_of_degree_mn=mean(price),\n    Price_of_degree_sd=sd(price),\n    n=n())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 4\n  public Price_of_degree_mn Price_of_degree_sd     n\n  <chr>               <dbl>              <dbl> <int>\n1 0                  52727.              9617.   438\n2 1                  24996.              4778.   268\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm2 <- t.test(\n  price ~ public, \n  data=earnings,\n  alternative=\"two.sided\",\n  var.equal=TRUE)\nm2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tTwo Sample t-test\n\ndata:  price by public\nt = 43.994, df = 704, p-value < 2.2e-16\nalternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0\n95 percent confidence interval:\n 26493.51 28968.64\nsample estimates:\nmean in group 0 mean in group 1 \n       52726.60        24995.52 \n```\n\n\n:::\n:::\n\n\nCompared to college graduates from public schools, private college graduates paid 27,800 USD more for their degree with a 95% CI lower of 26,493 USD and upper of 28,968 USD.\n\n\n\n## Box plots of earnings by University type to compare normality\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nearnings |>\n  ggplot(aes(public, earn)) +\n    geom_boxplot() +\n    ggtitle(\"Graph drawn by Leroy Wheeler on 2024-10-22\") +\n    xlab(\"Public University\") +\n    ylab(\"Salary after Graduation (USD)\") +\n    coord_flip()\n```\n\n::: {.cell-output-display}\n![](wheeler-5501-15-earnings_files/figure-html/box plot-2-1.png){width=672}\n:::\n:::\n\n\nThe box plots of the salary data in each of group appears normally distributed in both groups. \n\n\n## Descriptive statistics for salary earned after graduation when distinguished by whether the graduates attended a private or public university\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nearnings |>\n  group_by(public) |>\n  summarize(\n    Salary_mn=mean(earn),\n    Salary_sd=sd(earn),\n    n=n())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 4\n  public Salary_mn Salary_sd     n\n  <chr>      <dbl>     <dbl> <int>\n1 0         45529.     7211.   438\n2 1         45709.     5852.   268\n```\n\n\n:::\n:::\n\n\nThe standard deviation of the salary in each group of college graduates is very similar so we can proceed with the T-test to determine if their means are different.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm3 <- t.test(\n  earn ~ public, \n  data=earnings,\n  alternative=\"two.sided\",\n  var.equal=TRUE)\nm3\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tTwo Sample t-test\n\ndata:  earn by public\nt = -0.34453, df = 704, p-value = 0.7305\nalternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0\n95 percent confidence interval:\n -1204.2172   844.6707\nsample estimates:\nmean in group 0 mean in group 1 \n       45529.45        45709.23 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nearnings|>\n\tggplot(aes(sat, earn)) +\n\t  geom_point() +\n\t  xlab(\"SAT scores\") +\n\t  ylab(\"Salary After Graduation (USD)\") +\n    geom_smooth(method=\"lm\", se=FALSE) +\n    ggtitle(\"Plot produced by Leroy Wheeler on 2024-10-20\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](wheeler-5501-15-earnings_files/figure-html/plot 2-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm4 <- lm(earn~sat, data=earnings)\nm4\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = earn ~ sat, data = earnings)\n\nCoefficients:\n(Intercept)          sat  \n   14468.09        27.26  \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglance(m4)$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.3066626\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: earn\n           Df     Sum Sq    Mean Sq F value    Pr(>F)    \nsat         1 9.7745e+09 9774546626  311.38 < 2.2e-16 ***\nResiduals 704 2.2099e+10   31391183                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nearnings|>\n\tggplot(aes(act, earn)) +\n\t  geom_point() +\n\t  xlab(\"ACT scores\") +\n\t  ylab(\"Salary After Graduation (USD)\") +\n    geom_smooth(method=\"lm\", se=FALSE) +\n    ggtitle(\"Plot produced by Leroy Wheeler on 2024-10-20\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](wheeler-5501-15-earnings_files/figure-html/plot 3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm5 <- lm(earn~act, data=earnings)\nm5\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = earn ~ act, data = earnings)\n\nCoefficients:\n(Intercept)          act  \n      18784         1073  \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglance(m5)$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.3034885\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: earn\n           Df     Sum Sq    Mean Sq F value    Pr(>F)    \nact         1 9.6734e+09 9673372714  306.75 < 2.2e-16 ***\nResiduals 704 2.2201e+10   31534896                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nearnings|>\n\tggplot(aes(sat, price)) +\n\t  geom_point() +\n\t  xlab(\"SAT scores\") +\n\t  ylab(\"Price of college degree (USD)\") +\n    geom_smooth(method=\"lm\", se=FALSE) +\n    ggtitle(\"Plot produced by Leroy Wheeler on 2024-10-25\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](wheeler-5501-15-earnings_files/figure-html/plot 4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm6 <- lm(earn~act, data=earnings)\nm6\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = earn ~ act, data = earnings)\n\nCoefficients:\n(Intercept)          act  \n      18784         1073  \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nglance(m6)$r.squared\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.3034885\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(m6)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: earn\n           Df     Sum Sq    Mean Sq F value    Pr(>F)    \nact         1 9.6734e+09 9673372714  306.75 < 2.2e-16 ***\nResiduals 704 2.2201e+10   31534896                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n",
    "supporting": [
      "wheeler-5501-15-earnings_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}