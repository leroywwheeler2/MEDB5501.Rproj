{
  "hash": "60827b614414adb7689692cba336e7a4",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Analysis of Wolf River pollution\"\nformat: \n  html:\n    embed-resources: true\n---\n\n\n\nThis program reads data on the relationship sampling depth and two pollutant concentrations. Find more information in the [data dictionary][dd].\n\n[dd]: https://github.com/pmean/datasets/blob/master/wolf-river-pollution.yaml\n\nThis program was written by Steve Simon on 2024-10-20 and is placed in the public domain.\n\n## Load the tidyverse library\n\nFor most of your programs, you should load the tidyverse library. The messages and warnings are suppressed.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(broom)\nlibrary(tidyverse)\n```\n:::\n\n\n\n## Read the data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nriver <- read_tsv(\n  file=\"../data/wolf-river-pollution.txt\",\n  col_names=TRUE,\n  col_types=\"cnn\")\nnames(river) <- tolower(names(river))\nglimpse(river)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 30\nColumns: 3\n$ depth  <chr> \"Surface\", \"Surface\", \"Surface\", \"Surface\", \"Surface\", \"Surface…\n$ aldrin <dbl> 3.08, 3.58, 3.81, 4.31, 4.35, 4.40, 3.67, 5.17, 5.17, 4.35, 5.1…\n$ hcb    <dbl> 3.74, 4.61, 4.00, 4.67, 4.87, 5.12, 4.52, 5.29, 5.74, 5.48, 6.0…\n```\n\n\n:::\n:::\n\n\n\n## Draw boxplots\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nriver |>\n  ggplot(aes(depth, aldrin)) +\n    geom_boxplot() +\n    xlab(\"River depth\") +\n    ylab(\"Aldrin concentration\") +\n    ggtitle(\"Graph drawn by Steve Simon on 2024-10-20\") +\n    coord_flip()\n```\n\n::: {.cell-output-display}\n![](simon-5501-10-river_files/figure-html/box-1-1.png){width=576}\n:::\n:::\n\n\n\nThe deeper you sample, the higher the concentration of Aldrin. The variation also increases as you go deeper. There are some minor deviations from normality, but nothing too serious.\n\n## Descriptive statistics\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nriver |>\n  group_by(depth) |>\n  summarize(\n    aldrin_mn=mean(aldrin),\n    aldrin_sd=sd(aldrin),\n    n=n())\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 4\n  depth    aldrin_mn aldrin_sd     n\n  <chr>        <dbl>     <dbl> <int>\n1 Bottom        6.02     1.58     10\n2 Middepth      5.02     1.10     10\n3 Surface       4.19     0.671    10\n```\n\n\n:::\n:::\n\n\n\nThe bottom samples have the highest average concentration and the highest amount of variability.\n\n## Analysis of variance table\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- aov(aldrin ~ depth, data=river)\ntidy(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 6\n  term         df sumsq meansq statistic  p.value\n  <chr>     <dbl> <dbl>  <dbl>     <dbl>    <dbl>\n1 depth         2  16.8   8.42      6.05  0.00674\n2 Residuals    27  37.5   1.39     NA    NA      \n```\n\n\n:::\n:::\n\n\n\nThe F-ratio is large and the p-value is less than alpha. You should reject the null hypothesis and conclude that at least two means differ from one another.\n\n## Pairwise tests\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTukeyHSD(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = aldrin ~ depth, data = river)\n\n$depth\n                   diff       lwr        upr     p adj\nMiddepth-Bottom  -1.002 -2.309584  0.3055842 0.1580741\nSurface-Bottom   -1.832 -3.139584 -0.5244158 0.0048136\nSurface-Middepth -0.830 -2.137584  0.4775842 0.2739689\n```\n\n\n:::\n:::\n\n\n\nThere is a statistically significant difference in average concentration of Aldrin between the surface measurements and the bottom measurements. The confidence interval, however, is very wide, indicating a large amount of sampling error. \n\nAlthough the average middepth measurements are larger than the surface measurements and smaller than the bottom measurements, the difference of about 0.8 to 1.0 units is not statistically significant.\n\n## Sample size calculation scenario\n\nYou want to replicate this study at a different site and want a lot more precision and power. If the amount of sampling error (mean squared within) is similar, and the populations means are very close (4.8 for the surface, 5.0 for the middepth, and 5.2 for the bottom), what sample size would you need to achieve 90% power with an alpha level of 0.05?\n\n## Sample size calculation, R code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nv <- var(c(4.8, 5.0, 5.2))\npower.anova.test(\n\tgroups=3,\n\tn=NULL,\n\tbetween.var=v,\n\twithin.var=1.39,\n\tsig.level=0.05,\n\tpower=0.90)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n     Balanced one-way analysis of variance power calculation \n\n         groups = 3\n              n = 220.8641\n    between.var = 0.04\n     within.var = 1.39\n      sig.level = 0.05\n          power = 0.9\n\nNOTE: n is number in each group\n```\n\n\n:::\n:::\n\n\n\n## Sample size calculation, interpretation\n\nA sample size of 221 measurements per depth level would provide 90% power for detecting a difference between means of 4.8, 5.0, and 5.2 in aldrin concentration. This assumes that the variation within groups is similar to the previous study (1.39) and an alpha level of 0.05.\n\n## Recalculate sample size, new scenario\n\nThere is no way in heaven or earth that you can afford to make 221 measurements at each depth. So give up the idea that you can detect changes in means across such a narrow range. Suppose that you want to be able to detect differences among means that are 4.5, 5.0, and 5.5. If you could live with that and if everything remains the same, what sample size would you need?\n\n## Recalculate sample size, R code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nv <- var(c(4.5, 5.0, 5.5))\npower.anova.test(\n\tgroups=3,\n\tn=NULL,\n\tbetween.var=v,\n\twithin.var=1.39,\n\tsig.level=0.05,\n\tpower=0.90)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n     Balanced one-way analysis of variance power calculation \n\n         groups = 3\n              n = 36.19717\n    between.var = 0.25\n     within.var = 1.39\n      sig.level = 0.05\n          power = 0.9\n\nNOTE: n is number in each group\n```\n\n\n:::\n:::\n\n\n\n## Recalculate sample size, interpretation. \n\nMuch better! A sample size of 37 measurements per depth level would provide 90% power for detecting a difference between means of 4.5, 5.0, and 5.5 in aldrin concentration. This assumes that the variation within groups is similar to the previous study (1.39) and an alpha level of 0.05.\n",
    "supporting": [
      "simon-5501-10-river_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}